<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Nest Official_02_(Modules, Middleware, Exception_filters, Pipes) - colinder&#39;s blog</title><meta name="Description" content="Hello New World"><meta property="og:url" content="https://colinder.github.io/nest-official_02_modules-middleware-exception_filters-pipes/">
  <meta property="og:site_name" content="colinder&#39;s blog">
  <meta property="og:title" content="Nest Official_02_(Modules, Middleware, Exception_filters, Pipes)">
  <meta property="og:description" content="NESTì˜ ê³µì‹ ë¬¸ì„œì˜ ë‚´ìš©ì„ í•œê¸€ë¡œ ë²ˆì—­í•˜ë©° ì´í•´í•˜ê¸° ì‰½ê²Œ ì •ë¦¬í•©ë‹ˆë‹¤._(Modules, Middleware, Exception_filters, Pipes)">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-14T09:14:10+09:00">
    <meta property="article:modified_time" content="2024-01-14T09:14:10+09:00">
    <meta property="article:tag" content="Nest">
    <meta property="og:image" content="https://colinder.github.io/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://colinder.github.io/logo.png">
  <meta name="twitter:title" content="Nest Official_02_(Modules, Middleware, Exception_filters, Pipes)">
  <meta name="twitter:description" content="NESTì˜ ê³µì‹ ë¬¸ì„œì˜ ë‚´ìš©ì„ í•œê¸€ë¡œ ë²ˆì—­í•˜ë©° ì´í•´í•˜ê¸° ì‰½ê²Œ ì •ë¦¬í•©ë‹ˆë‹¤._(Modules, Middleware, Exception_filters, Pipes)">
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://colinder.github.io/nest-official_02_modules-middleware-exception_filters-pipes/" /><link rel="prev" href="https://colinder.github.io/staticdynamictype/" /><link rel="next" href="https://colinder.github.io/nest-official_03_guards-interceptors-custom_decorators/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><meta name="google-site-verification" content="colinder" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Nest Official_02_(Modules, Middleware, Exception_filters, Pipes)",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/colinder.github.io\/nest-official_02_modules-middleware-exception_filters-pipes\/"
        },"genre": "posts","keywords": "Nest","wordcount":  17559 ,
        "url": "https:\/\/colinder.github.io\/nest-official_02_modules-middleware-exception_filters-pipes\/","datePublished": "2024-01-14T09:14:10+09:00","dateModified": "2024-01-14T09:14:10+09:00","license": "colinder","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "colinder"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="auto" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="colinder&#39;s blog">Hello New World</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories/" title="ëŒ€ë¶„ë¥˜"> Categories </a><a class="menu-item" href="/posts/" title="ê²Œì‹œê¸€"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="ê²€ìƒ‰í•  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="colinder&#39;s blog">Hello New World</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="ê²€ìƒ‰í•  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/categories/" title="ëŒ€ë¶„ë¥˜">Categories</a><a class="menu-item" href="/posts/" title="ê²Œì‹œê¸€">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Nest Official_02_(Modules, Middleware, Exception_filters, Pipes)</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>colinder</a></span>&nbsp;<span class="post-category">included in <a href="/categories/nest/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Nest</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-01-14">2024-01-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;17559 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;36 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#modules">Modules</a>
      <ul>
        <li><a href="#feature-moduleshttpsdocsnestjscommodulesfeature-modules">Feature modules<a href="https://docs.nestjs.com/modules#feature-modules">#</a></a></li>
        <li><a href="#shared-moduleshttpsdocsnestjscommodulesshared-modules">Shared modules<a href="https://docs.nestjs.com/modules#shared-modules">#</a></a></li>
        <li><a href="#module-re-exportinghttpsdocsnestjscommodulesmodule-re-exporting">Module re-exporting<a href="https://docs.nestjs.com/modules#module-re-exporting">#</a></a></li>
        <li><a href="#dependency-injectionhttpsdocsnestjscommodulesdependency-injection">Dependency injection<a href="https://docs.nestjs.com/modules#dependency-injection">#</a></a></li>
        <li><a href="#global-moduleshttpsdocsnestjscommodulesglobal-modules">Global modules<a href="https://docs.nestjs.com/modules#global-modules">#</a></a></li>
        <li><a href="#dynamic-moduleshttpsdocsnestjscommodulesdynamic-modules">Dynamic modules<a href="https://docs.nestjs.com/modules#dynamic-modules">#</a></a></li>
      </ul>
    </li>
    <li><a href="#middleware">Middleware</a>
      <ul>
        <li><a href="#dependency-injectionhttpsdocsnestjscommiddlewaredependency-injection">Dependency injection<a href="https://docs.nestjs.com/middleware#dependency-injection">#</a></a></li>
        <li><a href="#applying-middlewarehttpsdocsnestjscommiddlewareapplying-middleware">Applying middleware<a href="https://docs.nestjs.com/middleware#applying-middleware">#</a></a></li>
        <li><a href="#route-wildcardshttpsdocsnestjscommiddlewareroute-wildcards">Route wildcards<a href="https://docs.nestjs.com/middleware#route-wildcards">#</a></a></li>
        <li><a href="#middleware-consumerhttpsdocsnestjscommiddlewaremiddleware-consumer">Middleware consumer<a href="https://docs.nestjs.com/middleware#middleware-consumer">#</a></a></li>
        <li><a href="#excluding-routeshttpsdocsnestjscommiddlewareexcluding-routes">Excluding routes<a href="https://docs.nestjs.com/middleware#excluding-routes">#</a></a></li>
        <li><a href="#functional-middlewarehttpsdocsnestjscommiddlewarefunctional-middleware">Functional middleware<a href="https://docs.nestjs.com/middleware#functional-middleware">#</a></a></li>
        <li><a href="#multiple-middlewarehttpsdocsnestjscommiddlewaremultiple-middleware">Multiple middleware<a href="https://docs.nestjs.com/middleware#multiple-middleware">#</a></a></li>
        <li><a href="#global-middlewarehttpsdocsnestjscommiddlewareglobal-middleware">Global middleware<a href="https://docs.nestjs.com/middleware#global-middleware">#</a></a></li>
      </ul>
    </li>
    <li><a href="#exception-filters">Exception filters</a>
      <ul>
        <li><a href="#throwing-standard-exceptionshttpsdocsnestjscomexception-filtersthrowing-standard-exceptions">Throwing standard exceptions<a href="https://docs.nestjs.com/exception-filters#throwing-standard-exceptions">#</a></a></li>
        <li><a href="#custom-exceptionshttpsdocsnestjscomexception-filterscustom-exceptions">Custom exceptions<a href="https://docs.nestjs.com/exception-filters#custom-exceptions">#</a></a></li>
        <li><a href="#built-in-http-exceptionshttpsdocsnestjscomexception-filtersbuilt-in-http-exceptions">Built-in HTTP exceptions<a href="https://docs.nestjs.com/exception-filters#built-in-http-exceptions">#</a></a></li>
        <li><a href="#exception-filtershttpsdocsnestjscomexception-filtersexception-filters-1">Exception filters<a href="https://docs.nestjs.com/exception-filters#exception-filters-1">#</a></a></li>
        <li><a href="#arguments-hosthttpsdocsnestjscomexception-filtersarguments-host">Arguments host<a href="https://docs.nestjs.com/exception-filters#arguments-host">#</a></a></li>
        <li><a href="#binding-filtershttpsdocsnestjscomexception-filtersbinding-filters">Binding filters<a href="https://docs.nestjs.com/exception-filters#binding-filters">#</a></a></li>
        <li><a href="#catch-everythinghttpsdocsnestjscomexception-filterscatch-everything">Catch everything<a href="https://docs.nestjs.com/exception-filters#catch-everything">#</a></a></li>
        <li><a href="#inheritanceìƒì†httpsdocsnestjscomexception-filtersinheritance">Inheritance(ìƒì†)<a href="https://docs.nestjs.com/exception-filters#inheritance">#</a></a></li>
      </ul>
    </li>
    <li><a href="#pipes">Pipes</a>
      <ul>
        <li><a href="#built-in-pipeshttpsdocsnestjscompipesbuilt-in-pipes">Built-in pipes<a href="https://docs.nestjs.com/pipes#built-in-pipes">#</a></a></li>
        <li><a href="#binding-pipeshttpsdocsnestjscompipesbinding-pipes">Binding pipes<a href="https://docs.nestjs.com/pipes#binding-pipes">#</a></a></li>
        <li><a href="#custom-pipeshttpsdocsnestjscompipescustom-pipes">Custom pipes<a href="https://docs.nestjs.com/pipes#custom-pipes">#</a></a></li>
        <li><a href="#schema-based-validationhttpsdocsnestjscompipesschema-based-validation">Schema based validation<a href="https://docs.nestjs.com/pipes#schema-based-validation">#</a></a></li>
        <li><a href="#object-schema-validationhttpsdocsnestjscompipesobject-schema-validation">Object schema validation<a href="https://docs.nestjs.com/pipes#object-schema-validation">#</a></a></li>
        <li><a href="#binding-validation-pipeshttpsdocsnestjscompipesbinding-validation-pipes">Binding validation pipes<a href="https://docs.nestjs.com/pipes#binding-validation-pipes">#</a></a></li>
        <li><a href="#class-validatorhttpsdocsnestjscompipesclass-validator">Class validator<a href="https://docs.nestjs.com/pipes#class-validator">#</a></a></li>
        <li><a href="#global-scoped-pipeshttpsdocsnestjscompipesglobal-scoped-pipes">Global scoped pipes<a href="https://docs.nestjs.com/pipes#global-scoped-pipes">#</a></a></li>
        <li><a href="#the-built-in-validationpipehttpsdocsnestjscompipesthe-built-in-validationpipe">The built-in ValidationPipe<a href="https://docs.nestjs.com/pipes#the-built-in-validationpipe">#</a></a></li>
        <li><a href="#transformation-use-casehttpsdocsnestjscompipestransformation-use-case">Transformation use case<a href="https://docs.nestjs.com/pipes#transformation-use-case">#</a></a></li>
        <li><a href="#providing-defaultshttpsdocsnestjscompipesproviding-defaults">Providing defaults<a href="https://docs.nestjs.com/pipes#providing-defaults">#</a></a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>â€‹</p>
<h2 id="modules">Modules</h2>
<p>ëª¨ë“ˆì€ <code>@Module()</code> ë°ì½”ë ˆì´í„°ë¡œ ì£¼ì„ì´ ë‹¬ë¦° í´ë˜ìŠ¤ì…ë‹ˆë‹¤. <code>@Module()</code> ë°ì½”ë ˆì´í„°ëŠ” Nestê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¡°ë¥¼ êµ¬ì„±í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ë©”íƒ€ë°ì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<p>ê° ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ìµœì†Œí•œ í•˜ë‚˜ì˜ ëª¨ë“ˆ, <strong>ë£¨íŠ¸ ëª¨ë“ˆ</strong>ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. <strong>ë£¨íŠ¸ ëª¨ë“ˆ</strong>ì€ Nestê°€ ì–´í”Œë¦¬ì¼€ì´ì…˜ ê·¸ë˜í”„ë¥¼ êµ¬ì¶•í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” ì‹œì‘ì ì…ë‹ˆë‹¤. <strong>ì–´í”Œë¦¬ì¼€ì´ì…˜ ê·¸ë˜í”„</strong>ëŠ” Nestê°€ Modules ë° Providers ê°„ì˜ ê´€ê³„ì™€ ì˜ì¡´ì„±ì„ í•´ê²°í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ë‚´ë¶€ ë°ì´í„° êµ¬ì¡°ì…ë‹ˆë‹¤. ë§¤ìš° ì‘ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš° ì´ë¡ ì ìœ¼ë¡œ ë£¨íŠ¸ ëª¨ë“ˆë§Œì„ ê°€ì§ˆ ìˆ˜ ìˆì§€ë§Œ, ì´ëŠ” ì¼ë°˜ì ì¸ ê²½ìš°ê°€ ì•„ë‹™ë‹ˆë‹¤. ëª¨ë“ˆì€ êµ¬ì„± ìš”ì†Œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ êµ¬ì„±í•˜ëŠ” ë° ê°•ë ¥í•˜ê²Œ ê¶Œì¥ë˜ëŠ” ë°©ë²•ì´ë©°, ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ê°ê°ì´ ë°€ì ‘í•œ ê´€ë ¨ì„±ì„ ê°€ì§„ ì¼ë ¨ì˜ ê¸°ëŠ¥ì„ ìº¡ìŠí™”í•˜ëŠ” ì—¬ëŸ¬ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ëŠ” ê²°ê³¼ë¡œì„œì˜ ì•„í‚¤í…ì²˜ê°€ í˜•ì„±ë©ë‹ˆë‹¤.</p>
<p><code>@Module()</code> ë°ì½”ë ˆì´í„°ëŠ” ëª¨ë“ˆì„ ì„¤ëª…í•˜ëŠ” ì†ì„±ë“¤ì´ ë‹´ê¸´ ë‹¨ì¼ ê°ì²´ë¥¼ ì¸ìë¡œ ë°›ìŠµë‹ˆë‹¤.</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th style="text-align: left"></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>providers</td>
          <td style="text-align: left">the providers that will be instantiated by the Nest injector and that may be shared at least across this module</td>
      </tr>
      <tr>
          <td>controllers</td>
          <td style="text-align: left">the set of controllers defined in this module which have to be instantiated</td>
      </tr>
      <tr>
          <td>imports</td>
          <td style="text-align: left">the list of imported modules that export the providers which are required in this module</td>
      </tr>
      <tr>
          <td>exports</td>
          <td style="text-align: left">the subset of <code>providers</code> that are provided by this module and should be available in other modules which import this module. You can use either the provider itself or just its token (<code>provide</code> value)</td>
      </tr>
  </tbody>
</table>
<p><strong>ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“ˆì€ í”„ë¡œë°”ì´ë”ë¥¼ ìº¡ìŠí™”í•©ë‹ˆë‹¤.</strong> <strong>ì´ëŠ” í˜„ì¬ ëª¨ë“ˆì— ì§ì ‘ ì†í•˜ì§€ ì•Šê±°ë‚˜ ê°€ì ¸ì˜¨ ëª¨ë“ˆì—ì„œ ë‚´ë³´ë‚´ì§€ì§€ ì•Šì€ í”„ë¡œë°”ì´ë”ë¥¼ ì£¼ì…í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸</strong>í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ëª¨ë“ˆì—ì„œ ë‚´ë³´ë‚´ëŠ” í”„ë¡œë°”ì´ë”ë¥¼ ëª¨ë“ˆì˜ ê³µê°œ ì¸í„°í˜ì´ìŠ¤ ë˜ëŠ” APIë¡œ ê°„ì£¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="feature-moduleshttpsdocsnestjscommodulesfeature-modules">Feature modules<a href="https://docs.nestjs.com/modules#feature-modules" target="_blank" rel="noopener noreffer ">#</a></h3>
<p><code>CatsController</code>ì™€ <code>CatsService</code>ëŠ” ë™ì¼í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë„ë©”ì¸ì— ì†í•©ë‹ˆë‹¤. ì„œë¡œ ë°€ì ‘í•˜ê²Œ ê´€ë ¨ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì´ë“¤ì„ <strong>feature module</strong>ë¡œ ì´ë™í•˜ëŠ” ê²ƒì´ í•©ë¦¬ì ì…ë‹ˆë‹¤. <strong>feature module</strong>ì€ ë‹¨ìˆœíˆ íŠ¹ì • ê¸°ëŠ¥ì— ê´€ë ¨ëœ ì½”ë“œë¥¼ ì¡°ì§í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì½”ë“œë¥¼ ì¡°ì§í•˜ê³  ëª…í™•í•œ ê²½ê³„ë¥¼ ì •ì˜í•¨ìœ¼ë¡œì¨ ë³µì¡ì„±ì„ ê´€ë¦¬í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ë˜ëŠ” íŒ€ì˜ ê·œëª¨ê°€ ì»¤ì§ì— ë”°ë¼ SOLID ì›ì¹™ì— ë”°ë¼ ê°œë°œí•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.</p>
<p>ì´ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´  <code>CatsModule</code>ì„ ë§Œë“­ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats/cats.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsController</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.controller&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.service&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">controllers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsController</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsService</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>To create a module using the CLI, simply execute the <code>$ nest g module cats</code> command.</p></blockquote>
<p>ìœ„ì— ìš°ë¦¬ëŠ”  <code>cats.module.ts</code>íŒŒì¼ ì•ˆì—  <code>CatsModule</code>ì„ ì •ì˜í•˜ê³ , ì´ ëª¨ë“ˆê³¼ ê´€ë ¨ëœ ëª¨ë“  ê²ƒì„ <code>cats</code> ë””ë ‰í† ë¦¬ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ í•´ì•¼ í•  ì¼ì€ ì´ ëª¨ë“ˆì„ ë£¨íŠ¸ ëª¨ë“ˆ(<code>app.module.ts</code> íŒŒì¼ì—ì„œ ì •ì˜ëœ <code>AppModule</code>)ì— ê°€ì ¸ì˜¤ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">// app.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats/cats.module&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsModule</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì´ì œ ìš°ë¦¬ í´ë” êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>
<blockquote>
<p>src</p>
<p>â”” cats</p>
<p>Â Â Â Â â”” dto</p>
<p>Â Â Â Â Â Â Â Â â”” create-cat.dto.ts</p>
<p>Â Â Â Â â”” interfaces</p>
<p>Â Â Â Â Â Â Â Â â”” cat.interface.ts</p>
<p>Â Â Â Â â”” cats.controller.ts</p>
<p>Â Â Â Â â”” cats.module.ts  ğŸ‘ˆ</p>
<p>Â Â Â Â â”” cats.service.ts</p>
<p>app.module.ts</p>
<p>main.ts</p></blockquote>
<p>â€‹</p>
<h3 id="shared-moduleshttpsdocsnestjscommodulesshared-modules">Shared modules<a href="https://docs.nestjs.com/modules#shared-modules" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>Nestì—ì„œëŠ” ëª¨ë“ˆì´ ê¸°ë³¸ì ìœ¼ë¡œ <strong>ì‹±ê¸€í†¤</strong>ì´ë©°, ë”°ë¼ì„œ ë™ì¼í•œ í”„ë¡œë°”ì´ë” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì—¬ëŸ¬ ëª¨ë“ˆ ê°„ì— ì†ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ëª¨ë“  ëª¨ë“ˆì€ ìë™ì ìœ¼ë¡œ ê³µìœ ëœ ëª¨ë“ˆì…ë‹ˆë‹¤. í•œ ë²ˆ ìƒì„±ë˜ë©´ ì–´ë–¤ ëª¨ë“ˆì•ˆì—ì„œë“ ì§€ ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ë‹¤ë¥¸ ëª¨ë“ˆ ê°„ì— <code>CatsService</code>ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ í•˜ê³ ì í•œë‹¤ë©´, ë¨¼ì € í•´ë‹¹ ëª¨ë“ˆì˜ <code>exports</code> ë°°ì—´ì— <code>CatsService</code> í”„ë¡œë°”ì´ë”ë¥¼ ì¶”ê°€í•˜ì—¬ ë‚´ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì´ ì‘ì„±ë©ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsController</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.controller&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.service&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">controllers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsController</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsService</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">exports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsService</span><span class="p">]</span>  <span class="err">ğŸ‘ˆ</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì´ì œ <code>CatsModule</code>ì„ ê°€ì ¸ì˜¤ëŠ” ëª¨ë“  ëª¨ë“ˆì€ <code>CatsService</code>ì— ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë‹¤ë¥¸ ëª¨ë“  ëª¨ë“ˆê³¼ ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ í•©ë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="module-re-exportinghttpsdocsnestjscommodulesmodule-re-exporting">Module re-exporting<a href="https://docs.nestjs.com/modules#module-re-exporting" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ìœ„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ëª¨ë“ˆì€ ë‚´ë¶€ í”„ë¡œë°”ì´ë”ë¥¼ ë‚´ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ê°€ì ¸ì˜¨ ëª¨ë“ˆì„ ë‹¤ì‹œ ë‚´ë³´ë‚¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì˜ˆì‹œì—ì„œëŠ” <code>CommonModule</code>ì´ <code>CoreModule</code>ì— ê°€ì ¸ì™€ì§€ê³  ë™ì‹œì— ë‚´ë³´ë‚´ì ¸ì„œ, ì´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CommonModule</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">exports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CommonM</span> <span class="nx">odule</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CoreModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹</p>
<h3 id="dependency-injectionhttpsdocsnestjscommodulesdependency-injection">Dependency injection<a href="https://docs.nestjs.com/modules#dependency-injection" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ëª¨ë“ˆ í´ë˜ìŠ¤ëŠ” providersì—ê²Œ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.(e.g., for configuration purposes):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">// cats.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsController</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.controller&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.service&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">controllers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsController</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsService</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsModule</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">catsService</span>: <span class="kt">CatsService</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ê·¸ëŸ¬ë‚˜ ëª¨ë“ˆ í´ë˜ìŠ¤ ìì²´ëŠ” ì›í˜• ì˜ì¡´ì„±(<a href="https://docs.nestjs.com/fundamentals/circular-dependency" target="_blank" rel="noopener noreffer ">circular dependency</a>)ìœ¼ë¡œ ì¸í•´ í”„ë¡œë°”ì´ë”ë¡œ ì£¼ì…ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
<p>â€‹</p>
<h3 id="global-moduleshttpsdocsnestjscommodulesglobal-modules">Global modules<a href="https://docs.nestjs.com/modules#global-modules" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ë§Œì•½ í•­ìƒ ë™ì¼í•œ ëª¨ë“ˆ ì„¸íŠ¸ë¥¼ ì–´ë””ì„œë‚˜ ê°€ì ¸ì™€ì•¼ í•˜ëŠ” ê²½ìš° ë²ˆê±°ë¡œì›Œì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Nestì—ì„œ Angularì™€ ë‹¬ë¦¬ <code>providers</code>ëŠ” ì „ì—­ ë²”ìœ„ì— ë“±ë¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•œ ë²ˆ ì •ì˜ë˜ë©´ í•´ë‹¹ providersëŠ” ì–´ë””ì—ì„œë‚˜ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ NestëŠ” providersë¥¼ ëª¨ë“ˆ ìŠ¤ì½”í”„ ë‚´ì— ìº¡ìŠí™”í•©ë‹ˆë‹¤. ìº¡ìŠí™”ëœ ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ì§€ ì•Šê³ ëŠ” í•´ë‹¹ ëª¨ë“ˆì˜ providersë¥¼ ë‹¤ë¥¸ ê³³ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
<p>ë§Œì•½ ì–´ë””ì„œë‚˜ ì‚¬ìš© ê°€ëŠ¥í•œ í”„ë¡œë°”ì´ë” ì§‘í•©ì„ ì œê³µí•˜ë ¤ë©´ (ì˜ˆ: í—¬í¼, ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë“±) ëª¨ë“ˆì— <code>@Global()</code> ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ <strong>ì „ì—­</strong>ìœ¼ë¡œ ì„¤ì •í•˜ì„¸ìš”.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span><span class="p">,</span> <span class="nx">Global</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsController</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.controller&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats.service&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Global</span><span class="p">()</span>  <span class="err">ğŸ‘ˆ</span>
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">controllers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsController</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsService</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">exports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsService</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>@Global()</code> ë°ì½”ë ˆì´í„°ëŠ” ëª¨ë“ˆì„ ì „ì—­ ë²”ìœ„ë¡œ ì„¤ì •í•©ë‹ˆë‹¤. ì „ì—­ ëª¨ë“ˆì€ ì¼ë°˜ì ìœ¼ë¡œ ë£¨íŠ¸ ë˜ëŠ” ì½”ì–´ ëª¨ë“ˆì—ì„œ í•œ ë²ˆë§Œ ë“±ë¡ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ìœ„ì˜ ì˜ˆì œì—ì„œ <code>CatsService</code> providersëŠ” ì–´ë””ì„œë‚˜ ì‚¬ìš© ê°€ëŠ¥í•˜ë©°, <strong>ì„œë¹„ìŠ¤ë¥¼ ì£¼ì…í•˜ë ¤ëŠ” ëª¨ë“ˆì€ imports ë°°ì—´ì— <code>CatsModule</code>ì„ ê°€ì ¸ì˜¤ì§€ ì•Šì•„ë„ ë  ê²ƒì…ë‹ˆë‹¤.</strong></p>
<blockquote>
<p><strong>HINT</strong></p>
<p>Making everything global is not a good design decision. Global modules are available to reduce the amount of necessary boilerplate. The <code>imports</code> array is generally the preferred way to make the module&rsquo;s API available to consumers.</p></blockquote>
<p>â€‹</p>
<h3 id="dynamic-moduleshttpsdocsnestjscommodulesdynamic-modules">Dynamic modules<a href="https://docs.nestjs.com/modules#dynamic-modules" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>Nest ëª¨ë“ˆ ì‹œìŠ¤í…œì—ëŠ” <strong>ë™ì  ëª¨ë“ˆ</strong>ì´ë¼ëŠ” ê°•ë ¥í•œ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ë™ì ìœ¼ë¡œ í”„ë¡œë°”ì´ë”ë¥¼ ë“±ë¡í•˜ê³  êµ¬ì„±í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ì ì •ì˜ ê°€ëŠ¥í•œ ëª¨ë“ˆì„ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë™ì  ëª¨ë“ˆì€  <a href="https://docs.nestjs.com/fundamentals/dynamic-modules" target="_blank" rel="noopener noreffer ">here</a>ì—ì„œ ìì„¸í•˜ê²Œ ë‹¤ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. ì´ ì¥ì—ì„œëŠ” ëª¨ë“ˆ ì†Œê°œë¥¼ ì™„ë£Œí•˜ê¸° ìœ„í•´ ê°„ëµí•œ ê°œìš”ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒì€ <code>DatabaseModule</code>ì˜ ë™ì  ëª¨ë“ˆ ì •ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span><span class="p">,</span> <span class="nx">DynamicModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createDatabaseProviders</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./database.providers&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Connection</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./connection.provider&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span><span class="nx">Connection</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">DatabaseModule</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">static</span> <span class="nx">forRoot</span><span class="p">(</span><span class="nx">entities</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">options</span><span class="o">?</span><span class="p">)</span><span class="o">:</span> <span class="nx">DynamicModule</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">providers</span> <span class="o">=</span> <span class="nx">createDatabaseProviders</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">entities</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">module</span>: <span class="kt">DatabaseModule</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">providers</span>: <span class="kt">providers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">exports</span>: <span class="kt">providers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p><code>forRoot()</code> ë©”ì„œë“œëŠ” ë™ê¸°ì ìœ¼ë¡œ ë˜ëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ(ì¦‰, Promiseë¥¼ í†µí•´) ë™ì  ëª¨ë“ˆì„ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>
<p>ì´ ëª¨ë“ˆì€ ê¸°ë³¸ì ìœ¼ë¡œ <code>Connection</code> providerë¥¼ ì •ì˜í•˜ì§€ë§Œ(<code>@Module()</code> ë°ì½”ë ˆì´í„° ë©”íƒ€ë°ì´í„°ì—ì„œ), ì¶”ê°€ë¡œ <code>forRoot()</code> ë©”ì„œë“œì— ì „ë‹¬ëœ <code>entities</code> ë° <code>options</code> ê°ì²´ì— ë”°ë¼ provider ì»¬ë ‰ì…˜ì„ ë…¸ì¶œí•©ë‹ˆë‹¤.(ì˜ˆë¥¼ ë“¤ë©´ ë¦¬í¬ì§€í† ë¦¬ë“¤) ë™ì  ëª¨ë“ˆì—ì„œ ë°˜í™˜ëœ ì†ì„±ì€ <code>@Module()</code> ë°ì½”ë ˆì´í„°ì—ì„œ ì •ì˜ëœ ê¸°ë³¸ ëª¨ë“ˆ ë©”íƒ€ë°ì´í„°ë¥¼ í™•ì¥(overrideê°€ ì•„ë‹Œ)í•˜ëŠ” ê²ƒì— ì£¼ëª©í•˜ì„¸ìš”. ì´ê²ƒì´ ì •ì ìœ¼ë¡œ ì„ ì–¸ëœ <code>Connection</code> providerì™€ ë™ì ìœ¼ë¡œ ìƒì„±ëœ ë¦¬í¬ì§€í† ë¦¬ providerê°€ ëª¨ë“ˆì—ì„œ ë‚´ë³´ë‚´ì§€ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.</p>
<p>ë™ì  ëª¨ë“ˆì„ ì „ì—­ ë²”ìœ„ì—ì„œ ë“±ë¡í•˜ë ¤ë©´ <code>global</code> ì†ì„±ì„ <code>true</code>ë¡œ ì„¤ì •í•˜ì„¸ìš”.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">global</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">module</span>: <span class="kt">DatabaseModule</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span>: <span class="kt">providers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">exports</span>: <span class="kt">providers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>WARNING</strong></p>
<p>As mentioned above, making everything global <strong>is not a good design decision</strong>.</p></blockquote>
<p><code>DatabaseModule</code>ì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ê°€ì ¸ì™€ êµ¬ì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">DatabaseModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./database/database.module&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">User</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./users/entities/user.entity&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span><span class="nx">DatabaseModule</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">([</span><span class="nx">User</span><span class="p">])],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ë§Œì•½ ë™ì  ëª¨ë“ˆì„ ë‹¤ì‹œ ë‚´ë³´ë‚´ë ¤ë©´, exports ë°°ì—´ì—ì„œ <code>forRoot()</code> ë©”ì„œë“œ í˜¸ì¶œì„ ìƒëµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">DatabaseModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./database/database.module&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">User</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./users/entities/user.entity&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span><span class="nx">DatabaseModule</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">([</span><span class="nx">User</span><span class="p">])],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">exports</span><span class="o">:</span> <span class="p">[</span><span class="nx">DatabaseModule</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <a href="https://docs.nestjs.com/fundamentals/dynamic-modules" target="_blank" rel="noopener noreffer ">Dynamic modules</a> chapter covers this topic in greater detail, and includes a <a href="https://github.com/nestjs/nest/tree/master/sample/25-dynamic-modules" target="_blank" rel="noopener noreffer ">working example</a>.</p>
<blockquote>
<p><strong>HINT</strong></p>
<p>Learn how to build highly customizable dynamic modules with the use of <code>ConfigurableModuleBuilder</code> here in <a href="https://docs.nestjs.com/fundamentals/dynamic-modules#configurable-module-builder" target="_blank" rel="noopener noreffer ">this chapter</a>.</p></blockquote>
<p>â€‹</p>
<p>â€‹</p>
<h2 id="middleware">Middleware</h2>
<p>ë¯¸ë“¤ì›¨ì–´ëŠ” ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ì´ì „ì— í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ëŠ” <code>ìš”ì²­</code> ë° <code>ì‘ë‹µ</code> ê°ì²´ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìœ¼ë©°, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìš”ì²­-ì‘ë‹µ ì£¼ê¸°ì—ì„œ <code>next()</code> ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ëŠ” ì¼ë°˜ì ìœ¼ë¡œ <code>next</code>ë¼ëŠ” ë³€ìˆ˜ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</p>
<p>Nest ë¯¸ë“¤ì›¨ì–´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ express ë¯¸ë“¤ì›¨ì–´ì™€ ë™ë“±í•©ë‹ˆë‹¤. ë‹¤ìŒì€ ê³µì‹ express ë¬¸ì„œì—ì„œ ê°€ì ¸ì˜¨ ë¯¸ë“¤ì›¨ì–´ì˜ ê¸°ëŠ¥ì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤:</p>
<blockquote>
<p>Middleware functions can perform the following tasks:</p>
<ul>
<li>execute any code.</li>
<li>make changes to the request and the response objects.</li>
<li>end the request-response cycle.</li>
<li>call the next middleware function in the stack.</li>
<li>if the current middleware function does not end the request-response cycle, it must call <code>next()</code> to pass control to the next middleware function. Otherwise, the request will be left hanging. (í˜„ì¬ì˜ ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ê°€ ìš”ì²­-ì‘ë‹µ ì£¼ê¸°ë¥¼ ì¢…ë£Œí•˜ì§€ ì•Šìœ¼ë©´ next()ë¥¼ í˜¸ì¶œí•˜ì—¬ ì œì–´ë¥¼ ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ë¡œ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ìš”ì²­ì´ ë¯¸í•´ê²° ìƒíƒœë¡œ ë‚¨ê²Œ ë©ë‹ˆë‹¤.)</li>
</ul></blockquote>
<p>Nest ë¯¸ë“¤ì›¨ì–´ëŠ” í•¨ìˆ˜ë¡œë„, ë˜ëŠ” <code>@Injectable()</code> ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•œ í´ë˜ìŠ¤ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í´ë˜ìŠ¤ëŠ” <code>NestMiddleware</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•˜ë©°, í•¨ìˆ˜ëŠ” íŠ¹ë³„í•œ ìš”êµ¬ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤. ê°„ë‹¨í•œ ë¯¸ë“¤ì›¨ì–´ ê¸°ëŠ¥ì„ í´ë˜ìŠ¤ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•˜ëŠ” ê²ƒìœ¼ë¡œ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<blockquote>
<p><strong>WARNING</strong></p>
<p><code>Express</code> and <code>fastify</code> handle middleware differently and provide different method signatures, read more <a href="https://docs.nestjs.com/techniques/performance#middleware" target="_blank" rel="noopener noreffer ">here</a>.</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//logger.middleware.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Injectable</span><span class="p">,</span> <span class="nx">NestMiddleware</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">Response</span><span class="p">,</span> <span class="nx">NextFunction</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;express&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Injectable</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">LoggerMiddleware</span> <span class="kr">implements</span> <span class="nx">NestMiddleware</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">use</span><span class="p">(</span><span class="nx">req</span>: <span class="kt">Request</span><span class="p">,</span> <span class="nx">res</span>: <span class="kt">Response</span><span class="p">,</span> <span class="nx">next</span>: <span class="kt">NextFunction</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Request...&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹</p>
<h3 id="dependency-injectionhttpsdocsnestjscommiddlewaredependency-injection">Dependency injection<a href="https://docs.nestjs.com/middleware#dependency-injection" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>Nest ë¯¸ë“¤ì›¨ì–´ëŠ” ì™„ì „íˆ ì˜ì¡´ì„± ì£¼ì…(Dependency Injection)ì„ ì§€ì›í•©ë‹ˆë‹¤. ë§ˆì¹˜ í”„ë¡œë°”ì´ë”(Providers)ì™€ ì»¨íŠ¸ë¡¤ëŸ¬(Controllers)ì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ë¯¸ë“¤ì›¨ì–´ë„ ë™ì¼í•œ ëª¨ë“ˆ ë‚´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì˜ì¡´ì„±ì„ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì „í†µì ìœ¼ë¡œ ì´ëŠ” ìƒì„±ì(Constructor)ë¥¼ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="applying-middlewarehttpsdocsnestjscommiddlewareapplying-middleware">Applying middleware<a href="https://docs.nestjs.com/middleware#applying-middleware" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>Nest.jsì—ì„œëŠ” <code>@Module()</code> ë°ì½”ë ˆì´í„°ì— ë¯¸ë“¤ì›¨ì–´ë¥¼ ì§ì ‘ ì„¤ì •í•  ìˆ˜ ìˆëŠ” ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ëŒ€ì‹ , ëª¨ë“ˆ í´ë˜ìŠ¤ì˜ <code>configure()</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ë¯¸ë“¤ì›¨ì–´ë¥¼ í¬í•¨í•˜ëŠ” ëª¨ë“ˆì€ <code>NestModule</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. <code>AppModule</code> ìˆ˜ì¤€ì—ì„œ <code>LoggerMiddleware</code>ë¥¼ ì„¤ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//app.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span><span class="p">,</span> <span class="nx">NestModule</span><span class="p">,</span> <span class="nx">MiddlewareConsumer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">LoggerMiddleware</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./common/middleware/logger.middleware&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats/cats.module&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsModule</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="kr">implements</span> <span class="nx">NestModule</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">configure</span><span class="p">(</span><span class="nx">consumer</span>: <span class="kt">MiddlewareConsumer</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">consumer</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">LoggerMiddleware</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">forRoutes</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” ì´ì „ì— <code>CatsController</code> ë‚´ì—ì„œ ì •ì˜ëœ <code>/cats</code> ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì— ëŒ€í•´ <code>LoggerMiddleware</code>ë¥¼ ì„¤ì •í–ˆìŠµë‹ˆë‹¤. ë˜í•œ, ë¯¸ë“¤ì›¨ì–´ë¥¼ íŠ¹ì • ìš”ì²­ ë©”ì„œë“œë¡œ ì œí•œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ë¯¸ë“¤ì›¨ì–´ë¥¼ êµ¬ì„±í•  ë•Œ <code>forRoutes()</code> ë©”ì„œë“œì— ë¼ìš°íŠ¸ ê²½ë¡œì™€ ìš”ì²­ ë©”ì„œë“œë¥¼ í¬í•¨í•˜ëŠ” ê°ì²´ë¥¼ ì „ë‹¬í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì•„ë˜ ì˜ˆì œì—ì„œëŠ” ì›í•˜ëŠ” ìš”ì²­ ë©”ì„œë“œ ìœ í˜•ì„ ì°¸ì¡°í•˜ê¸° ìœ„í•´ <code>RequestMethod</code>ì—´ê±°í˜•ì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒì— ì£¼ëª©í•˜ì„¸ìš”.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//app.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span><span class="p">,</span> <span class="nx">NestModule</span><span class="p">,</span> <span class="nx">RequestMethod</span><span class="p">,</span> <span class="nx">MiddlewareConsumer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span> <span class="err">ğŸ‘ˆ</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">LoggerMiddleware</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./common/middleware/logger.middleware&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats/cats.module&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsModule</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="kr">implements</span> <span class="nx">NestModule</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">configure</span><span class="p">(</span><span class="nx">consumer</span>: <span class="kt">MiddlewareConsumer</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">consumer</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">LoggerMiddleware</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">forRoutes</span><span class="p">({</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;cats&#39;</span><span class="p">,</span> <span class="nx">method</span>: <span class="kt">RequestMethod.GET</span> <span class="p">});</span>  <span class="err">ğŸ‘ˆ</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p><code>configure()</code> ë©”ì„œë“œëŠ” <code>async/await</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, <code>configure()</code> ë©”ì„œë“œ ë³¸ë¬¸ ë‚´ì—ì„œ ë¹„ë™ê¸° ì‘ì—…ì˜ ì™„ë£Œë¥¼ <code>await</code>í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>
<blockquote>
<p><strong>WARNING</strong></p>
<p><code>express</code> ì–´ëŒ‘í„°ë¥¼ ì‚¬ìš©í•  ë•Œ, NestJS ì•±ì€ ê¸°ë³¸ì ìœ¼ë¡œ <code>body-parser</code> íŒ¨í‚¤ì§€ì—ì„œ ì œê³µí•˜ëŠ” <code>json</code> ë° <code>urlencoded</code> ë¯¸ë“¤ì›¨ì–´ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤. ë”°ë¼ì„œ <code>MiddlewareConsumer</code>ë¥¼ í†µí•´ ì´ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©ì ì •ì˜í•˜ë ¤ë©´ <code>NestFactory.create()</code>ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒì„±í•  ë•Œ <code>bodyParser</code> í”Œë˜ê·¸ë¥¼ <code>false</code>ë¡œ ì„¤ì •í•˜ì—¬ ì „ì—­ ë¯¸ë“¤ì›¨ì–´ë¥¼ ë¹„í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤.</p></blockquote>
<p>â€‹</p>
<h3 id="route-wildcardshttpsdocsnestjscommiddlewareroute-wildcards">Route wildcards<a href="https://docs.nestjs.com/middleware#route-wildcards" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>íŒ¨í„´ ê¸°ë°˜ ë¼ìš°íŠ¸ë„ ì§€ì›ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë³„í‘œ(*)ëŠ” ì™€ì¼ë“œì¹´ë“œë¡œ ì‚¬ìš©ë˜ë©° ì–´ë– í•œ ë¬¸ì ì¡°í•©ì´ë“  ì¼ì¹˜í•©ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="nx">forRoutes</span><span class="p">({</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;ab*cd&#39;</span><span class="p">,</span> <span class="nx">method</span>: <span class="kt">RequestMethod.ALL</span> <span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>'ab*cd'</code> ë¼ìš°íŠ¸ ê²½ë¡œëŠ” <code>abcd</code>, <code>ab_cd</code>, <code>abecd</code> ë“±ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤. ë¼ìš°íŠ¸ ê²½ë¡œì—ëŠ” <code>?</code> , <code>+</code> , <code>*</code> ë° <code>()</code>ì™€ ê°™ì€ ë¬¸ìê°€ ì‚¬ìš©ë  ìˆ˜ ìˆìœ¼ë©°, ì´ë“¤ì€ ì •ê·œ í‘œí˜„ì‹ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ ì§‘í•©ì…ë‹ˆë‹¤. í•˜ì´í”ˆ(<code>-</code>)ê³¼ ì (<code>.</code>)ì€ ë¬¸ìì—´ ê¸°ë°˜ ê²½ë¡œì—ì„œ ê¸€ì ê·¸ëŒ€ë¡œ í•´ì„ë©ë‹ˆë‹¤.</p>
<blockquote>
<p><strong>WARNING</strong></p>
<p>The <code>fastify</code> package uses the latest version of the <code>path-to-regexp</code> package, which no longer supports wildcard asterisks <code>*</code>. Instead, you must use parameters (e.g., <code>(.*)</code>, <code>:splat*</code>).</p></blockquote>
<p>â€‹</p>
<h3 id="middleware-consumerhttpsdocsnestjscommiddlewaremiddleware-consumer">Middleware consumer<a href="https://docs.nestjs.com/middleware#middleware-consumer" target="_blank" rel="noopener noreffer ">#</a></h3>
<p><code>MiddlewareConsumer</code>ì€ ë„ìš°ë¯¸ í´ë˜ìŠ¤ë¡œ, ë¯¸ë“¤ì›¨ì–´ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ë‚´ì¥ ë©”ì„œë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ë“¤ì€ ëª¨ë‘ ê°„í¸í•˜ê²Œ <a href="https://en.wikipedia.org/wiki/Fluent_interface" target="_blank" rel="noopener noreffer ">fluent style</a>ë¡œ ì—°ê²°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code>forRoutes()</code> ë©”ì„œë“œëŠ” ë‹¨ì¼ ë¬¸ìì—´, ì—¬ëŸ¬ ë¬¸ìì—´, <code>RouteInfo</code> ê°ì²´, ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤, ì‹¬ì§€ì–´ ì—¬ëŸ¬ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¥¼ ì¸ìˆ˜ë¡œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ì»¨íŠ¸ë¡¤ëŸ¬ ëª©ë¡ì„ ì „ë‹¬í•  ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ëŠ” ë‹¨ì¼ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‚¬ìš©í•œ ì˜ˆì œì…ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//app.moduls.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span><span class="p">,</span> <span class="nx">NestModule</span><span class="p">,</span> <span class="nx">MiddlewareConsumer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">LoggerMiddleware</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./common/middleware/logger.middleware&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats/cats.module&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsController</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./cats/cats.controller&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsModule</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="kr">implements</span> <span class="nx">NestModule</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">configure</span><span class="p">(</span><span class="nx">consumer</span>: <span class="kt">MiddlewareConsumer</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">consumer</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">LoggerMiddleware</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">forRoutes</span><span class="p">(</span><span class="nx">CatsController</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p><code>apply()</code> ë©”ì„œë“œëŠ” ë‹¨ì¼ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì·¨í•  ìˆ˜ë„ ìˆê³ , <a href="https://docs.nestjs.com/middleware#multiple-middleware" target="_blank" rel="noopener noreffer ">ë‹¤ì¤‘ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì§€ì •</a>í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ì¸ìˆ˜ë¥¼ ì·¨í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p></blockquote>
<p>â€‹</p>
<h3 id="excluding-routeshttpsdocsnestjscommiddlewareexcluding-routes">Excluding routes<a href="https://docs.nestjs.com/middleware#excluding-routes" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ë•Œë¡œëŠ” íŠ¹ì • ë¼ìš°íŠ¸ì—ì„œ ë¯¸ë“¤ì›¨ì–´ë¥¼ <strong>ì ìš©í•˜ì§€ ì•Šë„ë¡</strong> í•˜ê³  ì‹¶ì„ ë•Œê°€ ìˆìŠµë‹ˆë‹¤. <code>exclude()</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ë¼ìš°íŠ¸ë¥¼ ì‰½ê²Œ ì œì™¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë©”ì„œë“œëŠ” ì œì™¸í•  ë¼ìš°íŠ¸ë¥¼ ì‹ë³„í•˜ëŠ” ë‹¨ì¼ ë¬¸ìì—´, ì—¬ëŸ¬ ë¬¸ìì—´ ë˜ëŠ” <code>RouteInfo</code> ê°ì²´ë¥¼ ì¸ìˆ˜ë¡œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="nx">consumer</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">LoggerMiddleware</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">exclude</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;cats&#39;</span><span class="p">,</span> <span class="nx">method</span>: <span class="kt">RequestMethod.GET</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;cats&#39;</span><span class="p">,</span> <span class="nx">method</span>: <span class="kt">RequestMethod.POST</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;cats/(.*)&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">forRoutes</span><span class="p">(</span><span class="nx">CatsController</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// forRoutes ë’¤ì— excludeë¥¼ ì‚¬ìš©í•˜ë©´ ì—ëŸ¬ë°œìƒ
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>The <code>exclude()</code> method supports wildcard parameters using the <a href="https://github.com/pillarjs/path-to-regexp#parameters" target="_blank" rel="noopener noreffer ">path-to-regexp</a> package.</p></blockquote>
<p>ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” <code>LoggerMiddleware</code>ê°€ <code>CatsController</code> ë‚´ì—ì„œ ì •ì˜ëœ ëª¨ë“  ë¼ìš°íŠ¸ì— ë°”ì¸ë”©ë˜ì§€ë§Œ, <code>exclude()</code> ë©”ì„œë“œì— ì „ë‹¬ëœ ì„¸ ê°œì˜ ë¼ìš°íŠ¸ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë¼ìš°íŠ¸ì— ì ìš©ë  ê²ƒì…ë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="functional-middlewarehttpsdocsnestjscommiddlewarefunctional-middleware">Functional middleware<a href="https://docs.nestjs.com/middleware#functional-middleware" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ìš°ë¦¬ê°€ ì‚¬ìš©í•œ <code>LoggerMiddleware</code> í´ë˜ìŠ¤ëŠ” ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤. ë©¤ë²„ë‚˜ ì¶”ê°€ì ì¸ ë©”ì„œë“œ, ì˜ì¡´ì„±ì´ ì—†ìŠµë‹ˆë‹¤. ì™œ í´ë˜ìŠ¤ ëŒ€ì‹ ì— ê°„ë‹¨í•œ í•¨ìˆ˜ë¡œ ì •ì˜í•  ìˆ˜ ì—†ì„ê¹Œìš”? ì‚¬ì‹¤, ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ í˜•ì˜ ë¯¸ë“¤ì›¨ì–´ë¥¼ <strong>í•¨ìˆ˜í˜• ë¯¸ë“¤ì›¨ì–´</strong>ë¼ê³  í•©ë‹ˆë‹¤. í´ë˜ìŠ¤ ê¸°ë°˜ì˜ <code>LoggerMiddleware</code>ë¥¼ í•¨ìˆ˜í˜• ë¯¸ë“¤ì›¨ì–´ë¡œ ë³€í™˜í•´ë³´ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ë‘ ë°©ì‹ì˜ ì°¨ì´ì ì„ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">Response</span><span class="p">,</span> <span class="nx">NextFunction</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;express&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kd">function</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">req</span>: <span class="kt">Request</span><span class="p">,</span> <span class="nx">res</span>: <span class="kt">Response</span><span class="p">,</span> <span class="nx">next</span>: <span class="kt">NextFunction</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Request...`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>ë‹¹ì‹ ì˜ ë¯¸ë“¤ì›¨ì–´ê°€ ì–´ë– í•œ ì˜ì¡´ì„±ë„ í•„ìš”ë¡œí•˜ì§€ ì•Šì„ ë•Œì—ëŠ”, ë” ê°„ë‹¨í•œ ëŒ€ì•ˆì¸ <strong>í•¨ìˆ˜í˜• ë¯¸ë“¤ì›¨ì–´</strong> ì‚¬ìš©ì„ ê³ ë ¤í•˜ì„¸ìš”.</p></blockquote>
<p>â€‹</p>
<h3 id="multiple-middlewarehttpsdocsnestjscommiddlewaremultiple-middleware">Multiple middleware<a href="https://docs.nestjs.com/middleware#multiple-middleware" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ìœ„ì—ì„œ ì–¸ê¸‰í•œëŒ€ë¡œ ì—¬ëŸ¬ ë¯¸ë“¤ì›¨ì–´ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ë ¤ë©´, <code>apply()</code> ë©”ì„œë“œ ë‚´ë¶€ì— ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ëª©ë¡ì„ ì œê³µí•˜ë©´ ë©ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="nx">consumer</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">cors</span><span class="p">(),</span> <span class="nx">helmet</span><span class="p">(),</span> <span class="nx">logger</span><span class="p">).</span><span class="nx">forRoutes</span><span class="p">(</span><span class="nx">CatsController</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹</p>
<h3 id="global-middlewarehttpsdocsnestjscommiddlewareglobal-middleware">Global middleware<a href="https://docs.nestjs.com/middleware#global-middleware" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ë§Œì•½ ëª¨ë“  ë“±ë¡ëœ ë¼ìš°íŠ¸ì— ë¯¸ë“¤ì›¨ì–´ë¥¼ í•œ ë²ˆì— ë°”ì¸ë”©í•˜ë ¤ë©´, <code>INestApplication</code>ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” <code>use()</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//main.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">NestFactory</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">AppModule</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">logger</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>ì „ì—­ ë¯¸ë“¤ì›¨ì–´ì—ì„œ <u>*DI container</u>ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. <code>app.use()</code>ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” ëŒ€ì‹  <a href="https://docs.nestjs.com/middleware#functional-middleware" target="_blank" rel="noopener noreffer ">í•¨ìˆ˜í˜• ë¯¸ë“¤ì›¨ì–´</a>ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜ëŠ” í´ë˜ìŠ¤ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ê³  <code>AppModule</code> (ë˜ëŠ” ë‹¤ë¥¸ ëª¨ë“ˆ) ë‚´ì—ì„œ <code>.forRoutes('*')</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì†Œë¹„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>
<p><span style='color: gray; font-size: 0.8em'>*DI container : DI(Dependency Injection) ì»¨í…Œì´ë„ˆëŠ” ì˜ì¡´ì„± ì£¼ì…ì„ ê´€ë¦¬í•˜ê³  ì œê³µí•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. NestJSì—ì„œëŠ” ë‚´ì¥ëœ DI ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì—¬ëŸ¬ ë¶€ë¶„ ê°„ì— ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤. <br>DIëŠ” ì½”ë“œë¥¼ ë” ëª¨ë“ˆí™”í•˜ê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ë©°, í…ŒìŠ¤íŠ¸ì™€ ê°™ì€ ì¸¡ë©´ì—ì„œë„ ì´ì ì„ ì œê³µí•©ë‹ˆë‹¤.DI ì»¨í…Œì´ë„ˆëŠ” í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , í´ë˜ìŠ¤ì˜ ìƒì„±ìì— í•„ìš”í•œ ì˜ì¡´ì„±ì„ í•´ê²°í•˜ì—¬ ê°ì²´ ê°„ì˜ ì˜ì¡´ì„±ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì½”ë“œëŠ” ëŠìŠ¨í•œ ê²°í•©ì„ ìœ ì§€í•˜ê³ , ìœ ì—°ì„±ê³¼ í…ŒìŠ¤íŠ¸ ìš©ì´ì„±ì„ ì¦ê°€ì‹œí‚µë‹ˆë‹¤. <br>ê°„ë‹¨íˆ ë§í•´, DI ì»¨í…Œì´ë„ˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤, ì»´í¬ë„ŒíŠ¸, ë° ì˜ì¡´ì„±ë“¤ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. NestJSì—ì„œëŠ” ì´ DI ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ê³  ëª¨ë“ˆì„ íš¨ê³¼ì ìœ¼ë¡œ ì¡°ì§í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span></p>
<p>â€‹</p>
<p>â€‹</p>
<h2 id="exception-filters">Exception filters</h2>
<p>NestëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì— ê±¸ì³ ëª¨ë“  ì²˜ë¦¬ë˜ì§€ ì•Šì€ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë‚´ì¥ ì˜ˆì™¸ ë ˆì´ì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì—ì„œ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì´ ë ˆì´ì–´ì— ì˜í•´ ì¡íˆë©°, ìë™ìœ¼ë¡œ ì ì ˆí•œ ì‚¬ìš©ì ì¹œí™”ì ì¸ ì‘ë‹µì„ ì „ì†¡í•©ë‹ˆë‹¤.</p>
<p>ê¸°ë³¸ì ìœ¼ë¡œ ì´ ë™ì‘ì€ ë‚´ì¥ëœ ì „ì—­ ì˜ˆì™¸ í•„í„°ì— ì˜í•´ ìˆ˜í–‰ë©ë‹ˆë‹¤. ì´ ì˜ˆì™¸ í•„í„°ëŠ” HttpException í˜•ì‹ì˜ ì˜ˆì™¸ (ê·¸ í•˜ìœ„ í´ë˜ìŠ¤ í¬í•¨)ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì˜ˆì™¸ê°€ ì¸ì‹ë˜ì§€ ì•Šì„ ë•Œ (HttpExceptionì´ë‚˜ HttpExceptionì—ì„œ ìƒì†ë˜ì§€ ì•Šì€ í´ë˜ìŠ¤), ë‚´ì¥ëœ ì˜ˆì™¸ í•„í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¸°ë³¸ JSON ì‘ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;statusCode&#34;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Internal server error&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>ì „ì—­ ì˜ˆì™¸ í•„í„°ëŠ” <code>http-errors</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¼ë¶€ ì§€ì›í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ <code>statusCode</code> ë° <code>message</code> ì†ì„±ì„ í¬í•¨í•˜ëŠ” ëª¨ë“  ë°œìƒí•œ ì˜ˆì™¸ëŠ” ì ì ˆí•˜ê²Œ ì±„ì›Œì ¸ ì‘ë‹µìœ¼ë¡œ ë°˜í™˜ë©ë‹ˆë‹¤ (ì¸ì‹ë˜ì§€ ì•Šì€ ì˜ˆì™¸ì— ëŒ€í•œ ê¸°ë³¸ <code>InternalServerErrorException</code> ëŒ€ì‹ ).</p></blockquote>
<p>â€‹</p>
<h3 id="throwing-standard-exceptionshttpsdocsnestjscomexception-filtersthrowing-standard-exceptions">Throwing standard exceptions<a href="https://docs.nestjs.com/exception-filters#throwing-standard-exceptions" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>NestëŠ” <code>@nestjs/common</code> íŒ¨í‚¤ì§€ì—ì„œ ë…¸ì¶œë˜ëŠ” ë‚´ì¥ <code>HttpException</code> í´ë˜ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì „í˜•ì ì¸ HTTP REST/GraphQL API ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” íŠ¹ì • ì˜¤ë¥˜ ì¡°ê±´ì´ ë°œìƒí•  ë•Œ í‘œì¤€ HTTP ì‘ë‹µ ê°ì²´ë¥¼ ë³´ë‚´ëŠ” ê²ƒì´ ì¢‹ì€ ê´€í–‰ì…ë‹ˆë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´, <code>CatsController</code>ì—ëŠ” <code>findAll()</code> ë©”ì„œë“œ(í•œ <code>GET</code> ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬)ê°€ ìˆìŠµë‹ˆë‹¤. ì´ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì–´ë–¤ ì´ìœ ë¡œë“  ì˜ˆì™¸ë¥¼ throwí•œë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ë¥¼ ì‹œì—°í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ í•˜ë“œ ì½”ë”©í•´ ë³´ê² ìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.controller.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Get</span><span class="p">,</span> <span class="nx">HttpException</span><span class="p">,</span> <span class="nx">HttpStatus</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findAll() {</span>
</span></span><span class="line"><span class="cl">  <span class="k">throw</span> <span class="k">new</span> <span class="nx">HttpException</span><span class="p">(</span><span class="s1">&#39;Forbidden&#39;</span><span class="p">,</span> <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">FORBIDDEN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>We used the <code>HttpStatus</code> here. This is a helper enum imported from the <code>@nestjs/common</code> package.</p></blockquote>
<p>í´ë¼ì´ì–¸íŠ¸ê°€ ì´ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í˜¸ì¶œí•˜ë©´ ì‘ë‹µì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì…ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;statusCode&#34;</span><span class="p">:</span> <span class="mi">403</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Forbidden&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>HttpException ìƒì„±ìëŠ” ì‘ë‹µì„ ê²°ì •í•˜ëŠ” ë‘ ê°€ì§€ í•„ìˆ˜ ì¸ìˆ˜ë¥¼ ë°›ìŠµë‹ˆë‹¤:</p>
<ul>
<li>
<p>response ì¸ìˆ˜ëŠ” JSON ì‘ë‹µ ë³¸ë¬¸ì„ ì •ì˜í•©ë‹ˆë‹¤. ì•„ë˜ì— ì„¤ëª…ëœëŒ€ë¡œ ë¬¸ìì—´ ë˜ëŠ” ê°ì²´ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p>status ì¸ìˆ˜ëŠ” <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank" rel="noopener noreffer ">HTTP status code</a>ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.</p>
</li>
</ul>
<p>ê¸°ë³¸ì ìœ¼ë¡œ JSON ì‘ë‹µ ë³¸ë¬¸ì€ ë‘ ê°€ì§€ ì†ì„±ì„ í¬í•¨í•©ë‹ˆë‹¤:</p>
<ul>
<li><code>statusCode</code>: status ì¸ìˆ˜ì—ì„œ ì œê³µëœ HTTP ìƒíƒœ ì½”ë“œë¡œ ê¸°ë³¸ ì„¤ì •ë©ë‹ˆë‹¤.</li>
<li><code>message</code>: statusë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ HTTP ì˜¤ë¥˜ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…</li>
</ul>
<p>JSON <code>ì‘ë‹µ</code> ë³¸ë¬¸ì˜ ë©”ì‹œì§€ ë¶€ë¶„ë§Œ ë®ì–´ì“°ë ¤ë©´ response ì¸ìˆ˜ì— ë¬¸ìì—´ì„ ì œê³µí•˜ë©´ ë©ë‹ˆë‹¤. ì „ì²´ JSON ì‘ë‹µ ë³¸ë¬¸ì„ ë®ì–´ì“°ë ¤ë©´ <code>response</code> ì¸ìˆ˜ì— ê°ì²´ë¥¼ ì „ë‹¬í•˜ë©´ ë©ë‹ˆë‹¤. NestëŠ” ê°ì²´ë¥¼ ì§ë ¬í™”í•˜ê³  ì´ë¥¼ JSON ì‘ë‹µ ë³¸ë¬¸ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
<p>ë‘ ë²ˆì§¸ ìƒì„±ì ì¸ìˆ˜ì¸ <code>status</code>ëŠ” ìœ íš¨í•œ HTTP ìƒíƒœ ì½”ë“œì—¬ì•¼ í•©ë‹ˆë‹¤. ê´€ë¡€ì ìœ¼ë¡œ <code>@nestjs/common</code>ì—ì„œ ê°€ì ¸ì˜¨ <code>HttpStatus</code> ì—´ê±°í˜•ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>
<p><strong>ì„¸ ë²ˆì§¸</strong> ìƒì„±ì ì¸ìˆ˜ (ì„ íƒì ) optionsëŠ” ì˜¤ë¥˜  <a href="https://nodejs.org/en/blog/release/v16.9.0/#error-cause" target="_blank" rel="noopener noreffer ">cause</a>ì„ ì œê³µí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ <code>ì›ì¸</code> ê°ì²´ëŠ” ì‘ë‹µ ê°ì²´ë¡œ ì§ë ¬í™”ë˜ì§€ ì•Šì§€ë§Œ <code>HttpException</code>ì´ throwë˜ëŠ” ë° ì›ì¸ì´ ëœ ë‚´ë¶€ ì˜¤ë¥˜ì— ëŒ€í•œ ìœ ìš©í•œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ë° ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì „ì²´ ì‘ë‹µ ë³¸ë¬¸ì„ ë®ì–´ì“°ê³  ì˜¤ë¥˜ ì›ì¸ì„ ì œê³µí•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.controller.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findAll() {</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">findAll</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">throw</span> <span class="k">new</span> <span class="nx">HttpException</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">status</span>: <span class="kt">HttpStatus.FORBIDDEN</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;This is a custom message&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">FORBIDDEN</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">cause</span>: <span class="kt">error</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Using the above, this is how the response would look:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;status&#34;</span><span class="p">:</span> <span class="mi">403</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;This is a custom message&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹</p>
<h3 id="custom-exceptionshttpsdocsnestjscomexception-filterscustom-exceptions">Custom exceptions<a href="https://docs.nestjs.com/exception-filters#custom-exceptions" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸ë¥¼ ì‘ì„±í•  í•„ìš”ê°€ ì—†ìœ¼ë©°, ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ì„¤ëª…í•˜ëŠ”ëŒ€ë¡œ ë‚´ì¥ëœ Nest HTTP ì˜ˆì™¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸ë¥¼ ê¸°ë³¸ <code>HttpException</code> í´ë˜ìŠ¤ì—ì„œ ìƒì†í•˜ëŠ” ì˜ˆì™¸ ê³„ì¸µì„ ë§Œë“œëŠ” ê²ƒì´ ì¢‹ì€ ê´€í–‰ì…ë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ Nestê°€ ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸ë¥¼ ì¸ì‹í•˜ê³  ì˜¤ë¥˜ ì‘ë‹µì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•  ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸ë¥¼ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//forbidden.exception.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">ForbiddenException</span> <span class="kr">extends</span> <span class="nx">HttpException</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">constructor</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">super</span><span class="p">(</span><span class="s1">&#39;Forbidden&#39;</span><span class="p">,</span> <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">FORBIDDEN</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>ForbiddenException</code>ì´ ê¸°ë³¸ <code>HttpException</code>ì„ í™•ì¥í•˜ë¯€ë¡œ ë‚´ì¥ëœ ì˜ˆì™¸ ì²˜ë¦¬ê¸°ì™€ ì›í™œí•˜ê²Œ ì‘ë™í•˜ë©°, ë”°ë¼ì„œ <code>findAll()</code> ë©”ì„œë“œ ë‚´ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="built-in-http-exceptionshttpsdocsnestjscomexception-filtersbuilt-in-http-exceptions">Built-in HTTP exceptions<a href="https://docs.nestjs.com/exception-filters#built-in-http-exceptions" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>NestëŠ” ê¸°ë³¸ <code>HttpException</code>ì„ ìƒì†í•˜ëŠ” ì¼ë ¨ì˜ í‘œì¤€ ì˜ˆì™¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ì˜ˆì™¸ë“¤ì€ <code>@nestjs/common</code> íŒ¨í‚¤ì§€ì—ì„œ ë…¸ì¶œë˜ë©°, ê°€ì¥ ì¼ë°˜ì ì¸ HTTP ì˜ˆì™¸ ì¤‘ ë§ì€ ê²ƒë“¤ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤:</p>
<ul>
<li><code>BadRequestException</code></li>
<li><code>UnauthorizedException</code></li>
<li><code>NotFoundException</code></li>
<li><code>ForbiddenException</code></li>
<li><code>NotAcceptableException</code></li>
<li><code>RequestTimeoutException</code></li>
<li><code>ConflictException</code></li>
<li><code>GoneException</code></li>
<li><code>HttpVersionNotSupportedException</code></li>
<li><code>PayloadTooLargeException</code></li>
<li><code>UnsupportedMediaTypeException</code></li>
<li><code>UnprocessableEntityException</code></li>
<li><code>InternalServerErrorException</code></li>
<li><code>NotImplementedException</code></li>
<li><code>ImATeapotException</code></li>
<li><code>MethodNotAllowedException</code></li>
<li><code>BadGatewayException</code></li>
<li><code>ServiceUnavailableException</code></li>
<li><code>GatewayTimeoutException</code></li>
<li><code>PreconditionFailedException</code></li>
</ul>
<p>ë‚´ì¥ ì˜ˆì™¸ë“¤ì€ options ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤ë¥˜ ì›ì¸ê³¼ ì˜¤ë¥˜ ì„¤ëª…ì„ ëª¨ë‘ ì œê³µí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="k">throw</span> <span class="k">new</span> <span class="nx">BadRequestException</span><span class="p">(</span><span class="s1">&#39;Something bad happened&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">cause</span>: <span class="kt">new</span> <span class="nb">Error</span><span class="p">(),</span> <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;Some error description&#39;</span> <span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ìœ„ì˜ ë‚´ìš©ì„ ì‚¬ìš©í•˜ë©´ ì‘ë‹µì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì¼ ê²ƒì…ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Something bad happened&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;Some error description&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;statusCode&#34;</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹</p>
<h3 id="exception-filtershttpsdocsnestjscomexception-filtersexception-filters-1">Exception filters<a href="https://docs.nestjs.com/exception-filters#exception-filters-1" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ê¸°ë³¸(ë‚´ì¥) ì˜ˆì™¸ í•„í„°ëŠ” ë§ì€ ê²½ìš°ë¥¼ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆì§€ë§Œ ì˜ˆì™¸ ë ˆì´ì–´ì— ëŒ€í•œ ì™„ì „í•œ ì œì–´ê°€ í•„ìš”í•œ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë¡œê¹…ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì–´ë–¤ ë™ì  ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ JSON ìŠ¤í‚¤ë§ˆë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì™¸ í•„í„°ëŠ” ì •í™•íˆ ì´ëŸ¬í•œ ëª©ì ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ë©´ íë¦„ ì œì–´ì™€ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚´ëŠ” ì‘ë‹µì˜ ë‚´ìš©ì„ ì •í™•í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>HttpException í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ ì˜ˆì™¸ë¥¼ catchí•˜ê³  í•´ë‹¹ ì˜ˆì™¸ì— ëŒ€í•´ ì‚¬ìš©ì ì •ì˜ ì‘ë‹µ ë¡œì§ì„ êµ¬í˜„í•˜ëŠ” ì˜ˆì™¸ í•„í„°ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ê¸°ë³¸ í”Œë«í¼ Request ë° Response ê°ì²´ì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•©ë‹ˆë‹¤. ì›ë³¸ urlì„ ê°€ì ¸ì™€ ë¡œê¹… ì •ë³´ì— í¬í•¨ì‹œí‚¤ê¸° ìœ„í•´ Request ê°ì²´ì— ì•¡ì„¸ìŠ¤í•©ë‹ˆë‹¤. response.json() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ ì „ì†¡ë˜ëŠ” ì‘ë‹µì„ ì œì–´í•˜ê¸° ìœ„í•´ Response ê°ì²´ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//http-exception.filter.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">ExceptionFilter</span><span class="p">,</span> <span class="nx">Catch</span><span class="p">,</span> <span class="nx">ArgumentsHost</span><span class="p">,</span> <span class="nx">HttpException</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">Response</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;express&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Catch</span><span class="p">(</span><span class="nx">HttpException</span><span class="p">)</span>   <span class="c1">//1ï¸âƒ£
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kr">class</span> <span class="nx">HttpExceptionFilter</span> <span class="kr">implements</span> <span class="nx">ExceptionFilter</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">catch</span><span class="p">(</span><span class="nx">exception</span>: <span class="kt">HttpException</span><span class="p">,</span> <span class="nx">host</span>: <span class="kt">ArgumentsHost</span><span class="p">)</span> <span class="p">{</span>     <span class="c1">//2ï¸âƒ£ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">switchToHttp</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getResponse</span><span class="p">&lt;</span><span class="nt">Response</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getRequest</span><span class="p">&lt;</span><span class="nt">Request</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">status</span> <span class="o">=</span> <span class="nx">exception</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">response</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">json</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">statusCode</span>: <span class="kt">status</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">timestamp</span>: <span class="kt">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="nx">path</span>: <span class="kt">request.url</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>ëª¨ë“  ì˜ˆì™¸ í•„í„°ëŠ” ì¼ë°˜ì ì¸ <code>ExceptionFilter&lt;T&gt;</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. ì´ê²ƒì€ <code>catch(exception: T, host: ArgumentsHost)</code> ë©”ì„œë“œë¥¼ í•´ë‹¹ ì‹œê·¸ë‹ˆì²˜ì™€ í•¨ê»˜ ì œê³µí•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ìš”êµ¬í•©ë‹ˆë‹¤. <code>T</code>ëŠ” ì˜ˆì™¸ì˜ ìœ í˜•ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p></blockquote>
<blockquote>
<p><strong>WARNING</strong></p>
<p>If you are using <code>@nestjs/platform-fastify</code> you can use <code>response.send()</code> instead of <code>response.json()</code>. Don&rsquo;t forget to import the correct types from <code>fastify</code>.</p></blockquote>
<p>1ï¸âƒ£<code>@Catch(HttpException)</code> ë°ì½”ë ˆì´í„°ëŠ” ì˜ˆì™¸ í•„í„°ì— í•„ìš”í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ë°”ì¸ë”©í•˜ë©°, ì´ë¥¼ í†µí•´ Nestì—ê²Œ ì´ íŠ¹ì • í•„í„°ê°€ HttpException ìœ í˜•ì˜ ì˜ˆì™¸ë¥¼ ì°¾ê³  ìˆìœ¼ë©° ë‹¤ë¥¸ ìœ í˜•ì˜ ì˜ˆì™¸ëŠ” ì°¾ì§€ ì•ŠëŠ”ë‹¤ê³  ì•Œë ¤ì¤ë‹ˆë‹¤. <code>@Catch()</code> ë°ì½”ë ˆì´í„°ëŠ” ë‹¨ì¼ ë§¤ê°œë³€ìˆ˜ ë˜ëŠ” ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ëª©ë¡ì„ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í•œ ë²ˆì— ì—¬ëŸ¬ ìœ í˜•ì˜ ì˜ˆì™¸ì— ëŒ€í•œ í•„í„°ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="arguments-hosthttpsdocsnestjscomexception-filtersarguments-host">Arguments host<a href="https://docs.nestjs.com/exception-filters#arguments-host" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>2ï¸âƒ£ <code>catch()</code> ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. <code>exception</code> ë§¤ê°œë³€ìˆ˜ëŠ” í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ì˜ˆì™¸ ê°ì²´ì…ë‹ˆë‹¤. <code>host</code> ë§¤ê°œë³€ìˆ˜ëŠ” <code>ArgumentsHost</code> ê°ì²´ì…ë‹ˆë‹¤. <code>ArgumentsHost</code>ëŠ” <a href="https://docs.nestjs.com/fundamentals/execution-context" target="_blank" rel="noopener noreffer "><u>*ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ì¥</u></a>ì—ì„œ ìì„¸íˆ ì‚´í´ë³¼ ê°•ë ¥í•œ ìœ í‹¸ë¦¬í‹° ê°ì²´ì…ë‹ˆë‹¤. ì´ ì½”ë“œ ìƒ˜í”Œì—ì„œëŠ” <code>ArgumentsHost</code>ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›ë³¸ ìš”ì²­ í•¸ë“¤ëŸ¬ì— ì „ë‹¬ë˜ëŠ” <code>Request</code> ë° <code>Response</code> ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ì–»ìŠµë‹ˆë‹¤(ì˜ˆì™¸ê°€ ë°œìƒí•œ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ). ì´ ì½”ë“œ ìƒ˜í”Œì—ì„œëŠ” <code>ArgumentsHost</code>ì˜ ëª‡ ê°€ì§€ ë„ìš°ë¯¸ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” <code>Request</code> ë° <code>Response</code> ê°ì²´ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. <code>ArgumentsHost</code>ì— ëŒ€í•´ ë” ì•Œì•„ë³´ë ¤ë©´ <a href="https://docs.nestjs.com/fundamentals/execution-context" target="_blank" rel="noopener noreffer ">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.</p>
<p><span style="color: gray; font-size: 0.8em">*ì´ ì¶”ìƒí™” ìˆ˜ì¤€ì˜ ì´ìœ ëŠ” &lsquo;ArgumentsHost&rsquo;ê°€ ëª¨ë“  ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê¸°ëŠ¥í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤(ì˜ˆë¥¼ ë“¤ì–´ í˜„ì¬ ì‘ì—… ì¤‘ì¸ HTTP ì„œë²„ ì»¨í…ìŠ¤íŠ¸ ë¿ë§Œ ì•„ë‹ˆë¼ Microservices ë° WebSocketsë„ í¬í•¨ë¨). ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ì¥ì—ì„œëŠ” <code>ArgumentsHost</code> ë° í•´ë‹¹ ë„ìš°ë¯¸ í•¨ìˆ˜ì˜ ê°•ë ¥í•¨ì„ í™œìš©í•˜ì—¬ <strong>ëª¨ë“ </strong> ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì— ëŒ€í•œ <a href="https://docs.nestjs.com/fundamentals/execution-context#host-methods" target="_blank" rel="noopener noreffer ">ê¸°ë³¸ ì¸ìˆ˜ì— ì•¡ì„¸ìŠ¤</a>í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¼ ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ëª¨ë“  ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‘ë™í•˜ëŠ” ì¼ë°˜ì ì¸ ì˜ˆì™¸ í•„í„°ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</span></p>
<p>â€‹</p>
<h3 id="binding-filtershttpsdocsnestjscomexception-filtersbinding-filters">Binding filters<a href="https://docs.nestjs.com/exception-filters#binding-filters" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ìƒˆë¡œìš´ <code>HttpExceptionFilter</code>ë¥¼ <code>CatsController</code>ì˜ <code>create()</code> ë©”ì„œë“œì— ì—°ê²°í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.controller.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Post</span><span class="p">,</span> <span class="nx">UseFilters</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Post</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kd">@UseFilters</span><span class="p">(</span><span class="k">new</span> <span class="nx">HttpExceptionFilter</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">create</span><span class="p">(</span><span class="kd">@Body</span><span class="p">()</span> <span class="nx">createCatDto</span>: <span class="kt">CreateCatDto</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">throw</span> <span class="k">new</span> <span class="nx">ForbiddenException</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>The <code>@UseFilters()</code> decorator is imported from the <code>@nestjs/common</code> package.</p></blockquote>
<p>ì—¬ê¸°ì„œ <code>@UseFilters()</code> ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. <code>@Catch()</code> ë°ì½”ë ˆì´í„°ì™€ ìœ ì‚¬í•˜ê²Œ ë‹¨ì¼ í•„í„° ì¸ìŠ¤í„´ìŠ¤ ë˜ëŠ” í•„í„° ì¸ìŠ¤í„´ìŠ¤ì˜ ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ëª©ë¡ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” <code>HttpExceptionFilter</code>ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ë˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì „ë‹¬í•˜ê³  (ì¸ìŠ¤í„´ìŠ¤ ëŒ€ì‹ ) í”„ë ˆì„ì›Œí¬ì— ì¸ìŠ¤í„´ìŠ¤í™” ì±…ì„ì„ ë‚¨ê¸°ê³  <strong>ì˜ì¡´ì„± ì£¼ì…</strong>ì„ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.controller.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">@Post</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kd">@UseFilters</span><span class="p">(</span><span class="nx">HttpExceptionFilter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">create</span><span class="p">(</span><span class="kd">@Body</span><span class="p">()</span> <span class="nx">createCatDto</span>: <span class="kt">CreateCatDto</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">throw</span> <span class="k">new</span> <span class="nx">ForbiddenException</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>ê°€ëŠ¥í•˜ë©´ ì¸ìŠ¤í„´ìŠ¤ ëŒ€ì‹  í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í•„í„°ë¥¼ ì ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ Nestê°€ ë™ì¼í•œ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ëª¨ë“ˆ ì „ì²´ì—ì„œ ì‰½ê²Œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆì–´ <strong>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ê°ì†Œ</strong>í•©ë‹ˆë‹¤.</p></blockquote>
<p>ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” HttpExceptionFilterê°€ ë‹¨ì¼ create() ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì—ë§Œ ì ìš©ë˜ì–´ ë©”ì„œë“œ ë²”ìœ„ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜ˆì™¸ í•„í„°ëŠ” ë©”ì„œë“œ ë²”ìœ„ì˜ ì»¨íŠ¸ë¡¤ëŸ¬/ë¦¬ì¡¸ë²„/ê²Œì´íŠ¸ì›¨ì´, ì»¨íŠ¸ë¡¤ëŸ¬ ë²”ìœ„, ë˜ëŠ” ì „ì—­ ë²”ìœ„ì—ì„œ ë²”ìœ„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í•„í„°ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ ë²”ìœ„ë¡œ ì„¤ì •í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.controller.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">@UseFilters</span><span class="p">(</span><span class="k">new</span> <span class="nx">HttpExceptionFilter</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì´ êµ¬ì„±ì€ <code>CatsController</code> ë‚´ì—ì„œ ì •ì˜ëœ ëª¨ë“  ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì— ëŒ€í•´ <code>HttpExceptionFilter</code>ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</p>
<p>ê¸€ë¡œë²Œ ë²”ìœ„ì˜ í•„í„°ë¥¼ ë§Œë“¤ë ¤ë©´ ë‹¤ìŒì„ ìˆ˜í–‰í•©ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//main.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">bootstrap() {</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">NestFactory</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">AppModule</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">app</span><span class="p">.</span><span class="nx">useGlobalFilters</span><span class="p">(</span><span class="k">new</span> <span class="nx">HttpExceptionFilter</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">bootstrap</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>WARNING</strong></p>
<p>The <code>useGlobalFilters()</code> method does not set up filters for gateways or hybrid applications.</p></blockquote>
<p>ê¸€ë¡œë²Œ ë²”ìœ„ì˜ í•„í„°ëŠ” ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ ë° ëª¨ë“  ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì— ê±¸ì³ ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ì¡´ì„± ì£¼ì… ì¸¡ë©´ì—ì„œ ëª¨ë“ˆì˜ ì»¨í…ìŠ¤íŠ¸ ì™¸ë¶€ì—ì„œ ë“±ë¡ëœ ê¸€ë¡œë²Œ í•„í„° (ìœ„ì˜ ì˜ˆì œì™€ ê°™ì´ <code>useGlobalFilters()</code>ë¥¼ ì‚¬ìš©í•¨)ëŠ” ëª¨ë“ˆì˜ ì»¨í…ìŠ¤íŠ¸ ì™¸ë¶€ì—ì„œ ìˆ˜í–‰ë˜ë¯€ë¡œ ì¢…ì†ì„±ì„ ì£¼ì…í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ë‹¤ìŒ êµ¬ì„±ì„ ì‚¬ìš©í•˜ì—¬ <strong>ì–´ë–¤ ëª¨ë“ˆì—ì„œë“  ì§ì ‘</strong> ê¸€ë¡œë²Œ ë²”ìœ„ì˜ í•„í„°ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//app.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">APP_FILTER</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/core&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">provide</span>: <span class="kt">APP_FILTER</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">useClass</span>: <span class="kt">HttpExceptionFilter</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ í•„í„°ì— ëŒ€í•œ ì¢…ì†ì„± ì£¼ì…ì„ ìˆ˜í–‰í•  ë•Œ ì´ êµ¬ì¡°ê°€ ì‚¬ìš©ë˜ëŠ” ëª¨ë“ˆì— ê´€ê³„ì—†ì´ í•„í„°ëŠ” ì‚¬ì‹¤ìƒ ì „ì—­ì ì…ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ì–´ë””ì—ì„œ ìˆ˜í–‰í•´ì•¼ í• ê¹Œìš”? í•„í„°(ìœ„ ì˜ˆì œì˜ <code>HttpExceptionFilter</code>)ê°€ ì •ì˜ëœ ëª¨ë“ˆì„ ì‚¬ìš©(Choose)í•˜ì‹­ì‹œì˜¤. ë˜í•œ <code>useClass</code>ê°€ ì‚¬ìš©ì ì§€ì • ê³µê¸‰ì ë“±ë¡ì„ ì²˜ë¦¬í•˜ëŠ” ìœ ì¼í•œ ë°©ë²•ì€ ì•„ë‹™ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank" rel="noopener noreffer ">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.</p></blockquote>
<p>ì´ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ í•„ìš”í•œ ë§Œí¼ ë§ì€ í•„í„°ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ê°ì„ providers ë°°ì—´ì— ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="catch-everythinghttpsdocsnestjscomexception-filterscatch-everything">Catch everything<a href="https://docs.nestjs.com/exception-filters#catch-everything" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ê´€ë¦¬í•˜ì§€ ì•Šì€ ëª¨ë“  ì˜ˆì™¸ë¥¼ ì¡ê¸° ìœ„í•´ì„œëŠ” (ì˜ˆì™¸ ìœ í˜•ê³¼ ê´€ê³„ì—†ì´) <code>@Catch()</code>ë°ì½”ë ˆì´í„°ì˜ ë§¤ê°œë³€ìˆ˜ ëª©ë¡ì„ ë¹„ì›Œë‘¡ë‹ˆë‹¤. ì˜ˆ: <code>@Catch()</code></p>
<p>ì•„ë˜ ì˜ˆì œì—ì„œëŠ” <a href="https://docs.nestjs.com/faq/http-adapter" target="_blank" rel="noopener noreffer ">HTTP adapter</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ë‹µì„ ì „ë‹¬í•˜ë©° í”Œë«í¼ì— êµ¬ì• ë°›ì§€ ì•ŠëŠ” ì½”ë“œì…ë‹ˆë‹¤. ë˜í•œ í”Œë«í¼ë³„ ê°ì²´ (<code>Request</code> ë° <code>Response</code>)ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ExceptionFilter</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Catch</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ArgumentsHost</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">HttpException</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">HttpStatus</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">HttpAdapterHost</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/core&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Catch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AllExceptionsFilter</span> <span class="kr">implements</span> <span class="nx">ExceptionFilter</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="kr">readonly</span> <span class="nx">httpAdapterHost</span>: <span class="kt">HttpAdapterHost</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">catch</span><span class="p">(</span><span class="nx">exception</span>: <span class="kt">unknown</span><span class="p">,</span> <span class="nx">host</span>: <span class="kt">ArgumentsHost</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// In certain situations `httpAdapter` might not be available in the
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// constructor method, thus we should resolve it here.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="p">{</span> <span class="nx">httpAdapter</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">httpAdapterHost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">switchToHttp</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">httpStatus</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">      <span class="nx">exception</span> <span class="k">instanceof</span> <span class="nx">HttpException</span>
</span></span><span class="line"><span class="cl">        <span class="o">?</span> <span class="nx">exception</span><span class="p">.</span><span class="nx">getStatus</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span> <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">INTERNAL_SERVER_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">responseBody</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">statusCode</span>: <span class="kt">httpStatus</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">timestamp</span>: <span class="kt">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">path</span>: <span class="kt">httpAdapter.getRequestUrl</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">getRequest</span><span class="p">()),</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">httpAdapter</span><span class="p">.</span><span class="nx">reply</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">getResponse</span><span class="p">(),</span> <span class="nx">responseBody</span><span class="p">,</span> <span class="nx">httpStatus</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>WARNING</strong></p>
<p>When combining an exception filter that catches everything with a filter that is bound to a specific type, the &ldquo;Catch anything&rdquo; filter <strong>should be declared</strong> first to allow the specific filter to correctly handle the bound type.</p></blockquote>
<p>â€‹</p>
<h3 id="inheritanceìƒì†httpsdocsnestjscomexception-filtersinheritance">Inheritance(ìƒì†)<a href="https://docs.nestjs.com/exception-filters#inheritance" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ì¼ë°˜ì ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì™„ì „íˆ ì‚¬ìš©ì ì •ì˜ëœ ì˜ˆì™¸ í•„í„°ë¥¼ ë§Œë“¤ ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ íŠ¹ì • ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‚´ìš©ì„ ë®ì–´ì“°ê¸° ìœ„í•´ ë‚´ì¥ëœ ê¸°ë³¸ ê¸€ë¡œë²Œ ì˜ˆì™¸ í•„í„°ë¥¼ í™•ì¥í•˜ê¸°ë¥¼ ì›í•˜ëŠ” ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ê¸°ë³¸ í•„í„°ì— ìœ„ì„í•˜ë ¤ë©´ <code>BaseExceptionFilter</code>ë¥¼ í™•ì¥í•˜ê³  ìƒì†ëœ <code>catch()</code>ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//all-exceptions.filter.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Catch</span><span class="p">,</span> <span class="nx">ArgumentsHost</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">BaseExceptionFilter</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/core&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Catch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AllExceptionsFilter</span> <span class="kr">extends</span> <span class="nx">BaseExceptionFilter</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">catch</span><span class="p">(</span><span class="nx">exception</span>: <span class="kt">unknown</span><span class="p">,</span> <span class="nx">host</span>: <span class="kt">ArgumentsHost</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">super</span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">exception</span><span class="p">,</span> <span class="nx">host</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>WARNING</strong></p>
<p><code>BaseExceptionFilter</code>ë¥¼ í™•ì¥í•˜ëŠ” ë©”ì„œë“œ ë° ì»¨íŠ¸ë¡¤ëŸ¬ ë²”ìœ„ í•„í„°ëŠ” <code>new</code>ë¡œ ì¸ìŠ¤í„´ìŠ¤í™”í•´ì„œëŠ” ì•ˆë©ë‹ˆë‹¤. ëŒ€ì‹  í”„ë ˆì„ì›Œí¬ê°€ ìë™ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.</p></blockquote>
<p>ìœ„ì˜ êµ¬í˜„ì€ ì ‘ê·¼ ë°©ì‹ì„ ë³´ì—¬ì£¼ëŠ” ë¼ˆëŒ€ì¼ ë¿ì…ë‹ˆë‹¤. í™•ì¥ëœ ì˜ˆì™¸ í•„í„°ì˜ ì‹¤ì œ êµ¬í˜„ì—ëŠ” íŠ¹ì •í•œ <strong>ë¹„ì¦ˆë‹ˆìŠ¤</strong> ë¡œì§ì´ í¬í•¨ë©ë‹ˆë‹¤(ì˜ˆ: ì—¬ëŸ¬ ì¡°ê±´ì„ ì²˜ë¦¬).</p>
<p>ì „ì—­ í•„í„°ëŠ” ê¸°ë³¸ í•„í„°ë¥¼ í™•ì¥<strong>í•  ìˆ˜ ìˆìŠµ</strong>ë‹ˆë‹¤. ì´ëŠ” ë‘ ê°€ì§€ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ ìˆ˜í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì²« ë²ˆì§¸ ë°©ë²•ì€ ì‚¬ìš©ì ì •ì˜ ì „ì—­ í•„í„°ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ë•Œ <code>HttpAdapter</code> ì°¸ì¡°ë¥¼ ì£¼ì…í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">bootstrap() {</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">NestFactory</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">AppModule</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">httpAdapter</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="nx">HttpAdapterHost</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">app</span><span class="p">.</span><span class="nx">useGlobalFilters</span><span class="p">(</span><span class="k">new</span> <span class="nx">AllExceptionsFilter</span><span class="p">(</span><span class="nx">httpAdapter</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">bootstrap</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ë‘ ë²ˆì§¸ ë°©ë²•ì€ APP_FILTER í† í°ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. <a href="https://docs.nestjs.com/exception-filters#binding-filters" target="_blank" rel="noopener noreffer ">as shown here</a>.</p>
<p>â€‹</p>
<p>â€‹</p>
<h2 id="pipes">Pipes</h2>
<blockquote>
<p><strong>í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ìœ íš¨ì„± ê²€ì‚¬, ê°€ê³µ ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” ì¤‘ê°„ ë ˆì´ì–´</strong></p></blockquote>
<p>íŒŒì´í”„ëŠ” <code>@Injectable()</code> ë°ì½”ë ˆì´í„°ë¡œ ì£¼ì„ì´ ë‹¬ë¦° í´ë˜ìŠ¤ë¡œ, <code>PipeTransform</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.</p>
<p>&ldquo;Pipes&quot;ëŠ” ì£¼ë¡œ ë‘ ê°€ì§€ ì‚¬ìš© ì‚¬ë¡€ê°€ ìˆìŠµë‹ˆë‹¤:</p>
<ol>
<li><strong>ë³€í™˜ (Transformation):</strong> ì…ë ¥ ë°ì´í„°ë¥¼ ì›í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¬¸ìì—´ì—ì„œ ì •ìˆ˜ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ë‚ ì§œ í˜•ì‹ì„ ë³€ê²½í•˜ëŠ” ë“±ì˜ ì‘ì—…ì´ ì—¬ê¸°ì— í•´ë‹¹ë©ë‹ˆë‹¤.</li>
<li><strong>ìœ íš¨ì„± ê²€ì‚¬ (Validation):</strong> ì…ë ¥ ë°ì´í„°ë¥¼ í‰ê°€í•˜ê³  ìœ íš¨í•œ ê²½ìš°ì—ëŠ” ë³€ê²½ ì—†ì´ ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ë©°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤. ì…ë ¥ ë°ì´í„°ì˜ ìœ íš¨ì„±ì„ í™•ì¸í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</li>
</ol>
<p>ë‘ ê²½ìš° ëª¨ë‘ íŒŒì´í”„ëŠ” <a href="https://docs.nestjs.com/controllers#route-parameters" target="_blank" rel="noopener noreffer ">ì»¨íŠ¸ë¡¤ëŸ¬ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬</a>ì—ì„œ ì²˜ë¦¬ë˜ëŠ” <code>ì¸ìˆ˜</code>ì— ì‘ìš©í•©ë‹ˆë‹¤. NestëŠ” ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê¸° ì§ì „ì— íŒŒì´í”„ë¥¼ ì‚½ì…í•˜ê³ , íŒŒì´í”„ëŠ” í•´ë‹¹ ë©”ì„œë“œì— ì „ë‹¬ë˜ëŠ” ì¸ìˆ˜ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤. ë³€í™˜ ë˜ëŠ” ìœ íš¨ì„± ê²€ì‚¬ ì‘ì—…ì€ ê·¸ë•Œ ìˆ˜í–‰ë˜ë©°, ì´í›„ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” (ê°€ëŠ¥í•œ ê²½ìš°) ë³€í™˜ëœ ì¸ìˆ˜ë¡œ í˜¸ì¶œë©ë‹ˆë‹¤.</p>
<p>Nestì—ëŠ” ì¦‰ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ë‚´ì¥ íŒŒì´í”„ê°€ ì œê³µë©ë‹ˆë‹¤. ë˜í•œ ì‚¬ìš©ì ì •ì˜ íŒŒì´í”„ë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ ì¥ì—ì„œëŠ” ë‚´ì¥ íŒŒì´í”„ë¥¼ ì†Œê°œí•˜ê³  ì´ë¥¼ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì— ë°”ì¸ë”©í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤„ ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ëª‡ ê°€ì§€ ì²˜ìŒë¶€í„° íŒŒì´í”„ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<blockquote>
<p><strong>HINT</strong></p>
<p>íŒŒì´í”„ëŠ” ì˜ˆì™¸ ì˜ì—­ ë‚´ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì¦‰, íŒŒì´í”„ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì˜ˆì™¸ ë ˆì´ì–´ (ì „ì—­ ì˜ˆì™¸ í•„í„° ë° í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ì— ì ìš©ëœ ëª¨ë“  <a href="https://docs.nestjs.com/exception-filters" target="_blank" rel="noopener noreffer ">ì˜ˆì™¸ í•„í„°</a>)ì—ì„œ ì²˜ë¦¬ë©ë‹ˆë‹¤. ìœ„ì˜ ë‚´ìš©ì„ ê³ ë ¤í•˜ë©´ íŒŒì´í”„ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ í›„ì†ìœ¼ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒì„ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì™¸ë¶€ ì†ŒìŠ¤ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ë°ì´í„°ë¥¼ ì‹œìŠ¤í…œ ê²½ê³„ì—ì„œ ìœ íš¨ì„± ê²€ì‚¬í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ìµœì„ ì˜ ì‹¤ì²œ ê¸°ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.</p></blockquote>
<p>â€‹</p>
<h3 id="built-in-pipeshttpsdocsnestjscompipesbuilt-in-pipes">Built-in pipes<a href="https://docs.nestjs.com/pipes#built-in-pipes" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>NestëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì•„ë˜ 9ê°œì˜ íŒŒì´í”„ë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
<ol>
<li><strong>ValidationPipe:</strong> ê¸°ë³¸ì ì¸ í˜•ì‹ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤.</li>
<li><strong>ParseIntPipe:</strong> ì „ë‹¬ëœ ê°’ì´ ìœ íš¨í•œ ì •ìˆ˜ì¸ì§€ í™•ì¸í•˜ê³ , ì •ìˆ˜ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤.</li>
<li><strong>ParseFloatPipe:</strong> ì „ë‹¬ëœ ê°’ì´ ìœ íš¨í•œ ë¶€ë™ ì†Œìˆ˜ì  ìˆ«ìì¸ì§€ í™•ì¸í•˜ê³ , ë¶€ë™ ì†Œìˆ˜ì ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤.</li>
<li><strong>ParseBoolPipe:</strong> ì „ë‹¬ëœ ê°’ì´ ìœ íš¨í•œ ë¶€ìš¸ ê°’ì¸ì§€ í™•ì¸í•˜ê³ , ë¶€ìš¸ ê°’ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤.</li>
<li><strong>ParseUUIDPipe:</strong> ì „ë‹¬ëœ ê°’ì´ UUID í˜•ì‹ì¸ì§€ í™•ì¸í•˜ê³ , UUIDë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤.</li>
<li><strong>DefaultValuePipe:</strong> ê¸°ë³¸ê°’ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°’ì´ ì£¼ì–´ì§€ì§€ ì•Šì€ ê²½ìš°, ì§€ì •ëœ ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
<li><strong>TransformPipe:</strong> ì‚¬ìš©ì ì •ì˜ ë³€í™˜ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ ê°’ì„ ë³€í™˜í•©ë‹ˆë‹¤.</li>
<li><strong>ValidationPipe:</strong> ì „ë‹¬ëœ ê°’ì´ ìœ íš¨í•œ DTO(Data Transfer Object)ì¸ì§€ í™•ì¸í•˜ê³ , ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤.</li>
<li><strong>ValidationPipe:</strong> DTOì˜ ìƒì„±ìì—ì„œ ìë™ìœ¼ë¡œ íƒ€ì… ìœ íš¨ì„±ì„ ê²€ì‚¬í•©ë‹ˆë‹¤. ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤.</li>
</ol>
<p>They&rsquo;re exported from the <code>@nestjs/common</code> package.</p>
<p>Let&rsquo;s take a quick look at using <code>ParseIntPipe</code>. This is an example of the <strong>transformation</strong> use case, where the pipe ensures that a method handler parameter is converted to a JavaScript integer (or throws an exception if the conversion fails). Later in this chapter, we&rsquo;ll show a simple custom implementation for a <code>ParseIntPipe</code>. The example techniques below also apply to the other built-in transformation pipes (<code>ParseBoolPipe</code>, <code>ParseFloatPipe</code>, <code>ParseEnumPipe</code>, <code>ParseArrayPipe</code> and <code>ParseUUIDPipe</code>, which we&rsquo;ll refer to as the <code>Parse*</code> pipes in this chapter).</p>
<p><code>ParseIntPipe</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê°„ë‹¨í•œ ì˜ˆì œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì´ëŠ” <strong>ë³€í™˜</strong>(use case)ì˜ ì˜ˆì‹œë¡œ, íŒŒì´í”„ëŠ” ë©”ì„œë“œ í•¸ë“¤ëŸ¬ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ JavaScript ì •ìˆ˜ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì„ ë³´ì¥í•˜ê±°ë‚˜(ë³€í™˜ì´ ì‹¤íŒ¨í•˜ë©´ ì˜ˆì™¸ë¥¼ throw), ë‚˜ì¤‘ì— ì´ ì¥ì—ì„œëŠ” <code>ParseIntPipe</code>ì— ëŒ€í•œ ê°„ë‹¨í•œ ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ì„ ë³´ì—¬ì¤„ ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ì˜ ì˜ˆì œ ê¸°ë²•ì€ ì´ ì¥ì—ì„œ ë‹¤ë£¨ëŠ” ë‹¤ë¥¸ ë‚´ì¥ ë³€í™˜ íŒŒì´í”„(<code>ParseBoolPipe</code>, <code>ParseFloatPipe</code>, <code>ParseEnumPipe</code>, <code>ParseArrayPipe</code> ë° <code>ParseUUIDPipe</code>, ì—¬ê¸°ì„œëŠ” <code>Parse*</code> íŒŒì´í”„ë¡œ ì°¸ì¡°í•©ë‹ˆë‹¤)ì—ë„ ì ìš©ë©ë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="binding-pipeshttpsdocsnestjscompipesbinding-pipes">Binding pipes<a href="https://docs.nestjs.com/pipes#binding-pipes" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>íŒŒì´í”„ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ íŒŒì´í”„ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì ì ˆí•œ ì»¨í…ìŠ¤íŠ¸ì— ì—°ê²°(ë°”ì¸ë”©)í•´ì•¼ í•©ë‹ˆë‹¤. <code>ParseIntPipe</code> ì˜ˆì œì—ì„œëŠ” íŒŒì´í”„ë¥¼ íŠ¹ì • ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì™€ ì—°ê´€ì‹œí‚¤ê³ , í•´ë‹¹ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê¸° ì „ì— íŒŒì´í”„ê°€ ì‹¤í–‰ë˜ë„ë¡ í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ì´ë¥¼ ë©”ì„œë“œ ë§¤ê°œë³€ìˆ˜ ë ˆë²¨ì—ì„œ íŒŒì´í”„ë¥¼ ë°”ì¸ë”©í•œë‹¤ê³  í‘œí˜„í•˜ê² ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findOne</span><span class="p">(</span><span class="kd">@Param</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">ParseIntPipe</span><span class="p">)</span> <span class="nx">id</span>: <span class="kt">number</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì´ëŸ¬ë©´ ë‘ ì¡°ê±´ ì¤‘ í•˜ë‚˜ê°€ ì°¸ì´ë¼ëŠ” ê²ƒì„ ë³´ì¥í•©ë‹ˆë‹¤. <code>findOne()</code> ë©”ì„œë“œì—ì„œ ë°›ëŠ” ë§¤ê°œë³€ìˆ˜ê°€ ìˆ«ìì´ê±°ë‚˜(as expected in our call to <code>this.catsService.findOne()</code>), ë¼ìš°í„° í•¸ë“¤ëŸ¬ì—ì„œ ì˜ˆì™¸ë¥¼ ì „ë‹¬í–ˆê±°ë‚˜.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒê³¼ ê°™ì´ ë¼ìš°íŠ¸ê°€ í˜¸ì¶œëœë‹¤ê³  ê°€ì •í•´ë³´ê² ìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">GET localhost:3000/abc
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>NestëŠ” ì•„ë˜ì™€ ê°™ì€ ì˜ˆì™¸ë¥¼ ì¤„ ê²ƒì…ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;statusCode&#34;</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Validation failed (numeric string is expected)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad Request&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì˜ˆì™¸ëŠ”  <code>findOne()</code>ë©”ì„œë“œì˜ ë³¸ë¬¸ ì‹¤í–‰ì„ ë°©ì§€í•  ê²ƒì…ë‹ˆë‹¤.</p>
<p>ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” í´ë˜ìŠ¤(<code>ParseIntPipe</code>)ë¥¼ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í”„ë ˆì„ì›Œí¬ì— ì¸ìŠ¤í„´ìŠ¤í™” ì±…ì„ì„ ë§¡ê²¨ ì˜ì¡´ì„± ì£¼ì…ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. íŒŒì´í”„ì™€ ê°€ë“œì™€ ë§ˆì°¬ê°€ì§€ë¡œ ëŒ€ì‹  in-place instanceë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. in-place instanceë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì€ ì˜µì…˜ì„ ì „ë‹¬í•˜ì—¬ ë‚´ì¥ íŒŒì´í”„ì˜ ë™ì‘ì„ ì‚¬ìš©ì ì •ì˜í•˜ê³  ì‹¶ì„ ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findOne</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@Param</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">ParseIntPipe</span><span class="p">({</span> <span class="nx">errorHttpStatusCode</span>: <span class="kt">HttpStatus.NOT_ACCEPTABLE</span> <span class="p">}))</span>
</span></span><span class="line"><span class="cl">  <span class="nx">id</span>: <span class="kt">number</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ë‹¤ë¥¸ ë³€í™˜ íŒŒì´í”„ë“¤ (<strong>Parse</strong>* íŒŒì´í”„ë“¤)ì„ ë°”ì¸ë”©í•˜ëŠ” ë°©ë²•ë„ ìœ ì‚¬í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ íŒŒì´í”„ë“¤ì€ ëª¨ë‘ ë¼ìš°íŠ¸ ë§¤ê°œë³€ìˆ˜, ì¿¼ë¦¬ ë¬¸ìì—´ ë§¤ê°œë³€ìˆ˜ ë° ìš”ì²­ ë³¸ë¬¸ ê°’ì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” ë§¥ë½ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤.</p>
<p>ì˜ˆë¥¼ ë“¤ì–´ ì¿¼ë¦¬ ë¬¸ìì—´ ë§¤ê°œë³€ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findOne</span><span class="p">(</span><span class="kd">@Query</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">ParseIntPipe</span><span class="p">)</span> <span class="nx">id</span>: <span class="kt">number</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì—¬ê¸°ì—ì„œëŠ” <code>ParseUUIDPipe</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ìì—´ ë§¤ê°œë³€ìˆ˜ë¥¼ êµ¬ë¬¸ ë¶„ì„í•˜ê³  í•´ë‹¹ ê°’ì´ UUIDì¸ì§€ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">(</span><span class="s1">&#39;:uuid&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findOne</span><span class="p">(</span><span class="kd">@Param</span><span class="p">(</span><span class="s1">&#39;uuid&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">ParseUUIDPipe</span><span class="p">())</span> <span class="nx">uuid</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">uuid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>When using <code>ParseUUIDPipe()</code> you are parsing UUID in version 3, 4 or 5, if you only require a specific version of UUID you can pass a version in the pipe options.</p></blockquote>
<p>ìœ„ì—ì„œëŠ” ë‹¤ì–‘í•œ ë‚´ì¥ íŒŒì´í”„ì¸ <strong>Parse*</strong> íŒ¨ë°€ë¦¬ë¥¼ ë°”ì¸ë”©í•˜ëŠ” ì˜ˆì œë¥¼ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ë°”ì¸ë”©í•˜ëŠ” ê²ƒì€ ì¡°ê¸ˆ ë‹¤ë¦…ë‹ˆë‹¤. ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ì´ì— ëŒ€í•´ ë…¼ì˜í•˜ê² ìŠµë‹ˆë‹¤.</p>
<blockquote>
<p><strong>HINT</strong></p>
<p><a href="https://docs.nestjs.com/techniques/validation" target="_blank" rel="noopener noreffer ">Validation techniques</a> ì„¹ì…˜ì—ì„œëŠ” ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ì— ëŒ€í•œ í¬ê´„ì ì¸ ì˜ˆì œë¥¼ ìì„¸íˆ ì‚´í´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>
<p>â€‹</p>
<h3 id="custom-pipeshttpsdocsnestjscompipescustom-pipes">Custom pipes<a href="https://docs.nestjs.com/pipes#custom-pipes" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ì–¸ê¸‰í•œëŒ€ë¡œ ì‚¬ìš©ì ì •ì˜ íŒŒì´í”„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. NestëŠ” ê°•ë ¥í•œ ë‚´ì¥ <code>ParseIntPipe</code>ì™€ <code>ValidationPipe</code>ë¥¼ ì œê³µí•˜ì§€ë§Œ, ê°ê°ì„ ì²˜ìŒë¶€í„° ê°„ë‹¨í•œ ì‚¬ìš©ì ì •ì˜ ë²„ì „ìœ¼ë¡œ ë§Œë“¤ì–´ë³´ë©´ ì–´ë–»ê²Œ ì‚¬ìš©ì ì •ì˜ íŒŒì´í”„ê°€ êµ¬ì„±ë˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ë¨¼ì € ê°„ë‹¨í•œ <code>ValidationPipe</code>ë¶€í„° ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” ì…ë ¥ ê°’ì„ ë°›ì•„ë“¤ì´ê³  ì¦‰ì‹œ ë™ì¼í•œ ê°’ì„ ë°˜í™˜í•˜ëŠ” ì‹ë³„ í•¨ìˆ˜ì²˜ëŸ¼ ë™ì‘í•˜ë„ë¡ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//validation.pipe.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">PipeTransform</span><span class="p">,</span> <span class="nx">Injectable</span><span class="p">,</span> <span class="nx">ArgumentMetadata</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Injectable</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">ValidationPipe</span> <span class="kr">implements</span> <span class="nx">PipeTransform</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">transform</span><span class="p">(</span><span class="nx">value</span>: <span class="kt">any</span><span class="p">,</span> <span class="nx">metadata</span>: <span class="kt">ArgumentMetadata</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p><code>PipeTransform&lt;T, R&gt;</code>ì€ ì–´ë– í•œ íŒŒì´í”„ë“  ë°˜ë“œì‹œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì œë„¤ë¦­ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. ì´ ì œë„¤ë¦­ ì¸í„°í˜ì´ìŠ¤ëŠ” ë³€í™˜ ë¡œì§ì„ ì •ì˜í•˜ê¸° ìœ„í•œ êµ¬ì¡°ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì œë„¤ë¦­ íƒ€ì… <code>T</code>ëŠ” ì…ë ¥ <code>value</code>ì˜ íƒ€ì…ì„ ë‚˜íƒ€ë‚´ê³ , <code>R</code>ì€ <code>transform()</code> ë©”ì„œë“œì˜ ë°˜í™˜ íƒ€ì…ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p></blockquote>
<p>ê° íŒŒì´í”„ëŠ” <code>PipeTransform</code> ì¸í„°í˜ì´ìŠ¤ ê³„ì•½ì„ ì¶©ì¡±ì‹œí‚¤ê¸° ìœ„í•´ <code>transform()</code> ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ë©”ì„œë“œëŠ” ë‘ ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°–ìŠµë‹ˆë‹¤:</p>
<ul>
<li>
<p><code>value</code></p>
</li>
<li>
<p><code>metadata</code></p>
</li>
</ul>
<p><code>value</code> ë§¤ê°œë³€ìˆ˜ëŠ” í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ë©”ì„œë“œ ì¸ì(argument)ë¥¼ ë‚˜íƒ€ë‚´ë©°(ë¼ìš°íŠ¸ ì²˜ë¦¬ ë©”ì„œë“œì—ì„œ ìˆ˜ì‹ ë˜ê¸° ì „), <code>metadata</code>ëŠ” í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ë©”ì„œë“œ ì¸ì(argument)ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë©”íƒ€ë°ì´í„° ê°ì²´ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì†ì„±ë“¤ì´ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">interface</span> <span class="nx">ArgumentMetadata</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">type</span><span class="o">:</span> <span class="s1">&#39;body&#39;</span> <span class="o">|</span> <span class="s1">&#39;query&#39;</span> <span class="o">|</span> <span class="s1">&#39;param&#39;</span> <span class="o">|</span> <span class="s1">&#39;custom&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">metatype?</span>: <span class="kt">Type</span><span class="p">&lt;</span><span class="nt">unknown</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">data?</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì´ëŸ¬í•œ ì†ì„±ë“¤ì€ í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ì¸ì(argument)ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>type</td>
          <td>í•´ë‹¹ ì†ì„±ì€ í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ë§¤ê°œë³€ìˆ˜ê°€ body <code>@Body()</code>, query <code>@Query()</code>, param <code>@Param()</code> ë˜ëŠ” ì‚¬ìš©ì ì •ì˜ ë§¤ê°œë³€ìˆ˜ì¸ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. (ìì„¸í•œ ë‚´ìš©ì€ <a href="https://docs.nestjs.com/custom-decorators" target="_blank" rel="noopener noreffer ">ì—¬ê¸°</a>ì—ì„œ í™•ì¸í•˜ì„¸ìš”.)</td>
      </tr>
      <tr>
          <td>metatype</td>
          <td>ì´ ì†ì„±ì€ ì¸ì(argument)ì˜ ë©”íƒ€íƒ€ì…ì„ ì œê³µí•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ <code>String</code>ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <br />ì£¼ì˜: ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ì—ì„œ íƒ€ì… ì„ ì–¸ì„ ìƒëµí•˜ê±°ë‚˜ ì¼ë°˜ JavaScriptë¥¼ ì‚¬ìš©í•œ ê²½ìš° ê°’ì€ <code>undefined</code>ì…ë‹ˆë‹¤.</td>
      </tr>
      <tr>
          <td>data</td>
          <td>ë°ì½”ë ˆì´í„°ì— ì „ë‹¬ëœ ë¬¸ìì—´, ì˜ˆë¥¼ ë“¤ë©´ <code>@Body('string')</code>ì—ì„œì˜ <code>'string'</code>ì…ë‹ˆë‹¤. ë°ì½”ë ˆì´í„° ê´„í˜¸ë¥¼ ë¹„ì›Œ ë‘” ê²½ìš° <code>undefined</code>ì…ë‹ˆë‹¤.</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p><strong>WARNING</strong></p>
<p>TypeScript ì¸í„°í˜ì´ìŠ¤ëŠ” íŠ¸ëœìŠ¤íŒŒì¼ ì¤‘ì— ì‚¬ë¼ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ ë©”ì„œë“œ ë§¤ê°œë³€ìˆ˜ì˜ íƒ€ì…ì´ í´ë˜ìŠ¤ ëŒ€ì‹  ì¸í„°í˜ì´ìŠ¤ë¡œ ì„ ì–¸ëœ ê²½ìš° <code>metatype</code> ê°’ì€ <code>Object</code>ê°€ ë  ê²ƒì…ë‹ˆë‹¤.</p></blockquote>
<p>â€‹</p>
<h3 id="schema-based-validationhttpsdocsnestjscompipesschema-based-validation">Schema based validation<a href="https://docs.nestjs.com/pipes#schema-based-validation" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ìš°ë¦¬ì˜ ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ì¢€ ë” ìœ ìš©í•˜ê²Œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. ì•„ë§ˆë„ <code>CatsController</code>ì˜ <code>create()</code> ë©”ì„œë“œë¥¼ ìì„¸íˆ ì‚´í´ë³´ë©´, ì„œë¹„ìŠ¤ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— ê²Œì‹œ ë³¸ë¬¸ ê°ì²´ê°€ ìœ íš¨í•œì§€ í™•ì¸í•˜ê³  ì‹¶ì„ ê²ƒì…ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Post</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">create</span><span class="p">(</span><span class="kd">@Body</span><span class="p">()</span> <span class="nx">createCatDto</span>: <span class="kt">CreateCatDto</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">createCatDto</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s focus in on the <code>createCatDto</code> body parameter. Its type is <code>CreateCatDto</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//create-cat.dto.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CreateCatDto</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">age</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">breed</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ìš°ë¦¬ëŠ” create ë©”ì„œë“œë¡œ ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  ìš”ì²­ì´ ìœ íš¨í•œ bodyë¥¼ í¬í•¨í•˜ê³ ìˆë‹¤ê³  ë³´ì¥í•˜ê³ ì í•©ë‹ˆë‹¤. ë”°ë¼ì„œ <code>createCatDto</code> ê°ì²´ì˜ ì„¸ ë©¤ë²„ë¥¼ ê²€ì¦í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì„ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ìˆ˜í–‰í•  ìˆ˜ ìˆì§€ë§Œ, ì´ë ‡ê²Œ í•˜ëŠ” ê²ƒì€ ë‹¨ì¼ ì±…ì„ ì›ì¹™(<strong>single responsibility principle</strong> (SRP))ì„ ê¹¨ëœ¨ë¦¬ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ë˜ ë‹¤ë¥¸ ì ‘ê·¼ ë°©ë²•ì€ <strong>validator class</strong>ë¥¼ ë§Œë“¤ê³  í•´ë‹¹ ì‘ì—…ì„ ê±°ê¸°ì— ìœ„ì„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ë°©ë²•ì€ ê° ë©”ì„œë“œì˜ ì‹œì‘ ë¶€ë¶„ì—ì„œì´ ìœ íš¨ì„± ê²€ì‚¬ê¸°ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ê¸°ì–µí•´ì•¼ í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤.</p>
<p>ìœ íš¨ì„± ê²€ì‚¬ ë¯¸ë“¤ì›¨ì–´ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì€ ì–´ë–¨ê¹Œìš”? ì´ëŠ” ì‘ë™í•  ìˆ˜ ìˆì§€ë§Œ ìœ ê°ìŠ¤ëŸ½ê²Œë„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì—ì„œ ëª¨ë“  ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” <strong>generic middleware</strong>ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ëŠ” ë¯¸ë“¤ì›¨ì–´ê°€ <strong>execution context</strong>, í˜¸ì¶œë  í•¸ë“¤ëŸ¬ ë° í•´ë‹¹ ë§¤ê°œë³€ìˆ˜ ë“±ì— ëŒ€í•´ ì•Œì§€ ëª»í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ë¬¼ë¡  ì´ëŸ° ìƒí™©ì´ íŒŒì´í”„ê°€ ì„¤ê³„ëœ ì •í™•í•œ ì‚¬ìš© ì‚¬ë¡€ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‹ˆ ì´ì œ ìš°ë¦¬ì˜ ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ë” ì •êµí•˜ê²Œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.</p>
<p>â€‹</p>
<h3 id="object-schema-validationhttpsdocsnestjscompipesobject-schema-validation">Object schema validation<a href="https://docs.nestjs.com/pipes#object-schema-validation" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ê°ì²´ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ê¹¨ë—í•˜ê³  DRY(Don&rsquo;t Repeat Yourself)í•œ ë°©ì‹ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ ì ‘ê·¼ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ì¸ ì ‘ê·¼ ë°©ë²• ì¤‘ í•˜ë‚˜ëŠ” ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ë²•ì„ ì‹œë„í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>Zod ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ì½ê¸° ì‰¬ìš´ APIë¡œ ê°„ë‹¨í•˜ê²Œ ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Zod ê¸°ë°˜ ìŠ¤í‚¤ë§ˆë¥¼ í™œìš©í•˜ëŠ” ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ë¨¼ì € í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">$ npm install --save zod
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì•„ë˜ì˜ ì½”ë“œ ìƒ˜í”Œì—ì„œëŠ” ìŠ¤í‚¤ë§ˆë¥¼ <code>constructor</code> ì¸ìë¡œ ë°›ëŠ” ê°„ë‹¨í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“­ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ìŠ¤í‚¤ë§ˆë¥¼ í†µí•´ ë“¤ì–´ì˜¤ëŠ” ì¸ìˆ˜ë¥¼ ê²€ì¦í•˜ëŠ” <code>schema.parse()</code> ë©”ì„œë“œë¥¼ ì ìš©í•©ë‹ˆë‹¤.</p>
<p>ì•ì„œ ì–¸ê¸‰í•œ ëŒ€ë¡œ <strong>validation pipe</strong> íŒŒì´í”„ëŠ” ê°’ì´ ë³€ê²½ë˜ì§€ ì•Šê±°ë‚˜ ì˜ˆì™¸ë¥¼ throwí•˜ëŠ” ë‘ ê°€ì§€ ë™ì‘ ì¤‘ í•˜ë‚˜ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒ ì„¹ì…˜ì—ì„œëŠ” <code>@UsePipes()</code> ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì— ì ì ˆí•œ ìŠ¤í‚¤ë§ˆë¥¼ ì œê³µí•˜ëŠ” ë°©ë²•ì„ ë³¼ ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ëª©í‘œë¡œí•œ ëŒ€ë¡œ ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ë‹¤ì–‘í•œ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">PipeTransform</span><span class="p">,</span> <span class="nx">ArgumentMetadata</span><span class="p">,</span> <span class="nx">BadRequestException</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">ZodSchema</span>  <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;zod&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">ZodValidationPipe</span> <span class="kr">implements</span> <span class="nx">PipeTransform</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">schema</span>: <span class="kt">ZodSchema</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">transform</span><span class="p">(</span><span class="nx">value</span>: <span class="kt">unknown</span><span class="p">,</span> <span class="nx">metadata</span>: <span class="kt">ArgumentMetadata</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">parsedValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">schema</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">parsedValue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">BadRequestException</span><span class="p">(</span><span class="s1">&#39;Validation failed&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹</p>
<h3 id="binding-validation-pipeshttpsdocsnestjscompipesbinding-validation-pipes">Binding validation pipes<a href="https://docs.nestjs.com/pipes#binding-validation-pipes" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ì´ì „ì—ëŠ” ë³€í™˜ íŒŒì´í”„(<code>ParseIntPipe</code> ë° ë‚˜ë¨¸ì§€ <code>Parse*</code> íŒŒì´í”„ì™€ ê°™ì€)ë¥¼ ë°”ì¸ë”©í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>
<p>ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ë°”ì¸ë”©í•˜ëŠ” ê²ƒë„ ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤.</p>
<p>ì´ ê²½ìš°ì—ëŠ” ë©”ì„œë“œ í˜¸ì¶œ ìˆ˜ì¤€ì—ì„œ íŒŒì´í”„ë¥¼ ë°”ì¸ë”©í•˜ê³ ì í•©ë‹ˆë‹¤. í˜„ì¬ ì˜ˆì œì—ì„œ <code>ZodValidationPipe</code>ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤:</p>
<ul>
<li>
<p>ZodValidationPipeì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±</p>
</li>
<li>
<p>íŒŒì´í”„ì˜ í´ë˜ìŠ¤ ìƒì„±ìì—ì„œ ì»¨í…ìŠ¤íŠ¸ë³„ Zod ìŠ¤í‚¤ë§ˆ ì „ë‹¬</p>
</li>
<li>
<p>íŒŒì´í”„ë¥¼ ë©”ì„œë“œì— ë°”ì¸ë”©</p>
</li>
</ul>
<p>Zod ìŠ¤í‚¤ë§ˆ ì˜ˆì œ:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">z</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;zod&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">createCatSchema</span> <span class="o">=</span> <span class="nx">z</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="kt">object</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span>: <span class="kt">z.string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">age</span>: <span class="kt">z.number</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">breed</span>: <span class="kt">z.string</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">required</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">type</span> <span class="nx">CreateCatDto</span> <span class="o">=</span> <span class="nx">z</span><span class="p">.</span><span class="k">infer</span><span class="p">&lt;</span><span class="nt">typeof</span> <span class="na">createCatSchema</span><span class="p">&gt;;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We do that using the <code>@UsePipes()</code> decorator as shown below:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.controller.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">@Post</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kd">@UsePipes</span><span class="p">(</span><span class="k">new</span> <span class="nx">ZodValidationPipe</span><span class="p">(</span><span class="nx">createCatSchema</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">create</span><span class="p">(</span><span class="kd">@Body</span><span class="p">()</span> <span class="nx">createCatDto</span>: <span class="kt">CreateCatDto</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">createCatDto</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>The <code>@UsePipes()</code> decorator is imported from the <code>@nestjs/common</code> package.</p></blockquote>
<blockquote>
<p><strong>WARNING</strong></p>
<p><code>zod</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ <code>tsconfig.json</code> íŒŒì¼ì—ì„œ <code>strictNullChecks</code> êµ¬ì„±ì´ í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p></blockquote>
<p>â€‹</p>
<h3 id="class-validatorhttpsdocsnestjscompipesclass-validator">Class validator<a href="https://docs.nestjs.com/pipes#class-validator" target="_blank" rel="noopener noreffer ">#</a></h3>
<blockquote>
<p><strong>WARNING</strong></p>
<p>The techniques in this section require TypeScript and are not available if your app is written using vanilla JavaScript.</p></blockquote>
<p>ìš°ë¦¬ì˜ ìœ íš¨ì„± ê²€ì‚¬ ê¸°ìˆ ì— ëŒ€í•œ ëŒ€ì•ˆì ì¸ êµ¬í˜„ì„ ì‚´í´ë´…ì‹œë‹¤.</p>
<p>NestëŠ” <a href="https://github.com/typestack/class-validator" target="_blank" rel="noopener noreffer ">class-validator</a> ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ì˜ ë™ì‘í•©ë‹ˆë‹¤. ì´ ê°•ë ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì½”ë ˆì´í„° ê¸°ë°˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°ì½”ë ˆì´í„° ê¸°ë°˜ ìœ íš¨ì„± ê²€ì‚¬ëŠ” íŠ¹íˆ Nestì˜ <strong>Pipe</strong>ê¸°ëŠ¥ê³¼ ê²°í•©ë  ë•Œ ë§¤ìš° ê°•ë ¥í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ìš°ë¦¬ëŠ” ì²˜ë¦¬ëœ í”„ë¡œí¼í‹°ì˜ <code>ë©”íƒ€íƒ€ì…</code>ì— ì ‘ê·¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì‹œì‘í•˜ê¸° ì „ì— í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">$ npm i --save class-validator class-transformer
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì´ëŸ¬í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œ í›„ì—ëŠ” <code>CreateCatDto</code> í´ë˜ìŠ¤ì— ëª‡ ê°€ì§€ ë°ì½”ë ˆì´í„°ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ìˆ ì˜ ì¤‘ìš”í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” <code>CreateCatDto</code> í´ë˜ìŠ¤ê°€ Post ë³¸ë¬¸ ê°ì²´ì˜ ë‹¨ì¼ ì§„ì‹¤ì˜ ì†ŒìŠ¤ë¡œ ìœ ì§€ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤ (ë³„ë„ì˜ ìœ íš¨ì„± ê²€ì‚¬ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//create-cat.dto.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">IsString</span><span class="p">,</span> <span class="nx">IsInt</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;class-validator&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CreateCatDto</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@IsString</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">@IsInt</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nx">age</span>: <span class="kt">number</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">@IsString</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nx">breed</span>: <span class="kt">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>Read more about the class-validator decorators <a href="https://github.com/typestack/class-validator#usage" target="_blank" rel="noopener noreffer ">here</a>.</p></blockquote>
<p>Now we can create a <code>ValidationPipe</code> class that uses these annotations.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//validation.pipe.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">PipeTransform</span><span class="p">,</span> <span class="nx">Injectable</span><span class="p">,</span> <span class="nx">ArgumentMetadata</span><span class="p">,</span> <span class="nx">BadRequestException</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">validate</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;class-validator&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">plainToInstance</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;class-transformer&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Injectable</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">ValidationPipe</span> <span class="kr">implements</span> <span class="nx">PipeTransform</span><span class="p">&lt;</span><span class="nt">any</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">async</span> <span class="nx">transform</span><span class="p">(</span><span class="nx">value</span>: <span class="kt">any</span><span class="p">,</span> <span class="p">{</span> <span class="nx">metatype</span> <span class="p">}</span><span class="o">:</span> <span class="nx">ArgumentMetadata</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">metatype</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">toValidate</span><span class="p">(</span><span class="nx">metatype</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="kt">object</span> <span class="o">=</span> <span class="nx">plainToInstance</span><span class="p">(</span><span class="nx">metatype</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">errors</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">validate</span><span class="p">(</span><span class="kt">object</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">BadRequestException</span><span class="p">(</span><span class="s1">&#39;Validation failed&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">private</span> <span class="nx">toValidate</span><span class="p">(</span><span class="nx">metatype</span>: <span class="kt">Function</span><span class="p">)</span><span class="o">:</span> <span class="kr">boolean</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">types</span>: <span class="kt">Function</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">String</span><span class="p">,</span> <span class="nb">Boolean</span><span class="p">,</span> <span class="nb">Number</span><span class="p">,</span> <span class="nb">Array</span><span class="p">,</span> <span class="nb">Object</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">!</span><span class="nx">types</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">metatype</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p><code>ValidationPipe</code>ì€ Nestì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µë˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ì •ì˜ ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ì§ì ‘ ì‘ì„±í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ë‚´ì¥ëœ <code>ValidationPipe</code>ì—ëŠ” ì´ ì¥ì—ì„œ ë§Œë“  ìƒ˜í”Œë³´ë‹¤ ë” ë§ì€ ì˜µì…˜ì´ ì œê³µë˜ë©°, ì´ ìƒ˜í”Œì€ ì‚¬ìš©ì ì •ì˜ íŒŒì´í”„ì˜ ë©”ì»¤ë‹ˆì¦˜ì„ ì„¤ëª…í•˜ê¸° ìœ„í•´ ê¸°ë³¸ì ìœ¼ë¡œ ìœ ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš© ë° ë‹¤ì–‘í•œ ì˜ˆì œëŠ” <a href="https://docs.nestjs.com/techniques/validation" target="_blank" rel="noopener noreffer ">ì—¬ê¸°</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote>
<blockquote>
<p><strong>NOTICE</strong></p>
<p>We used the <a href="https://github.com/typestack/class-transformer" target="_blank" rel="noopener noreffer ">class-transformer</a> library above which is made by the same author as the <strong>class-validator</strong> library, and as a result, they play very well together.</p></blockquote>
<p>ì´ ì½”ë“œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ë¨¼ì €, <code>transform()</code> ë©”ì„œë“œê°€ <code>async</code>ë¡œ í‘œì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” Nestê°€ ë™ê¸°ì  ë° ë¹„ë™ê¸°ì  íŒŒì´í”„ë¥¼ ëª¨ë‘ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ ë©”ì„œë“œë¥¼ <code>async</code>ë¡œ ë§Œë“  ì´ìœ ëŠ” class-validatorì˜ ì¼ë¶€ ê²€ì¦ì´ <a href="https://github.com/typestack/class-validator#custom-validation-classes" target="_blank" rel="noopener noreffer ">ë¹„ë™ê¸°ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸</a>ì…ë‹ˆë‹¤ (Promisesë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤).</p>
<p>ë‹¤ìŒìœ¼ë¡œ destructuringì„ ì‚¬ìš©í•˜ì—¬ <code>metatype</code> í•„ë“œë¥¼ (<code>ArgumentMetadata</code>ì—ì„œ ì´ ë©¤ë²„ë§Œ ì¶”ì¶œí•˜ì—¬) <code>metatype</code> ë§¤ê°œë³€ìˆ˜ë¡œ í• ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” <code>ArgumentMetadata</code> ì „ì²´ë¥¼ ì–»ëŠ” ëŒ€ì‹  ì¶”ê°€ ë¬¸ì„ ì¶”ê°€í•˜ì—¬ <code>metatype</code> ë³€ìˆ˜ë¥¼ í• ë‹¹í•˜ëŠ” ë‹¨ì¶• í‘œê¸°ë²•ì¼ ë¿ì…ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒìœ¼ë¡œ <code>toValidate()</code>ë¼ëŠ” ë„ìš°ë¯¸ í•¨ìˆ˜ì— ì£¼ëª©í•˜ì„¸ìš”. ì´ í•¨ìˆ˜ëŠ” í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ì¸ìˆ˜ê°€ ê¸°ë³¸ JavaScript íƒ€ì…ì¸ ê²½ìš° (ì´ë“¤ì—ëŠ” ìœ íš¨ì„± ê²€ì‚¬ ë°ì½”ë ˆì´í„°ê°€ ì—°ê²°ë  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ìœ íš¨ì„± ê²€ì‚¬ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤) ê²€ì¦ ë‹¨ê³„ë¥¼ ìš°íšŒí•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒìœ¼ë¡œ <code>plainToInstance()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ë°˜ JavaScript ì¸ìˆ˜ ê°ì²´ë¥¼ íƒ€ì…ì´ ì§€ì •ëœ ê°ì²´ë¡œ ë³€í™˜í•˜ì—¬ ìœ íš¨ì„±ì„ ì ìš©í•©ë‹ˆë‹¤. ì´ë¥¼ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ” ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì—ì„œ ì—­ì§ë ¬í™”ëœ ë“¤ì–´ì˜¤ëŠ” post body ê°ì²´ì—ëŠ” <strong>ì–´ë–¤ íƒ€ì… ì •ë³´ë„ ì—†ê¸° ë•Œë¬¸</strong>ì…ë‹ˆë‹¤ (ì´ëŠ” Expressì™€ ê°™ì€ ê¸°ë³¸ í”Œë«í¼ì˜ ë™ì‘ ë°©ì‹ì…ë‹ˆë‹¤). Class-validatorëŠ” ì•ì„œ DTOì— ì •ì˜í•œ ìœ íš¨ì„± ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ë¯€ë¡œ ì´ ë³€í™˜ì„ ìˆ˜í–‰í•˜ì—¬ ë“¤ì–´ì˜¤ëŠ” ë³¸ë¬¸ì„ ì ì ˆíˆ ë°ì½”ë ˆì´íŠ¸ëœ ê°ì²´ë¡œ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ì•ì„œ ì–¸ê¸‰í–ˆë“¯ì´ ì´ëŠ” <strong>ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„</strong>ì´ê¸° ë•Œë¬¸ì— ê°’ì´ ë³€ê²½ë˜ì§€ ì•Šê±°ë‚˜ ì˜ˆì™¸ë¥¼ throwí•˜ëŠ” ë‘ ê°€ì§€ ë™ì‘ ì¤‘ í•˜ë‚˜ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>
<p>ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” <code>ValidationPipe</code>ë¥¼ ë°”ì¸ë”©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íŒŒì´í”„ëŠ” ë§¤ê°œë³€ìˆ˜ ìŠ¤ì½”í”„, ë©”ì„œë“œ ìŠ¤ì½”í”„, ì»¨íŠ¸ë¡¤ëŸ¬ ìŠ¤ì½”í”„ ë˜ëŠ” ê¸€ë¡œë²Œ ìŠ¤ì½”í”„ë¡œ ë°”ì¸ë”©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•ì„œ Zod ê¸°ë°˜ì˜ ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ì—ì„œ ë©”ì„œë“œ ë ˆë²¨ì—ì„œ íŒŒì´í”„ë¥¼ ë°”ì¸ë”©í•˜ëŠ” ì˜ˆì œë¥¼ ë³´ì•˜ìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì˜ˆì œì—ì„œëŠ” íŒŒì´í”„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì˜ <code>@Body()</code> ë°ì½”ë ˆì´í„°ì— ë°”ì¸ë”©í•˜ì—¬ íŒŒì´í”„ê°€ í˜¸ì¶œë˜ì–´ post bodyë¥¼ ìœ íš¨ì„± ê²€ì‚¬í•˜ë„ë¡ ë§Œë“­ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//cats.controller.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">@Post</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">create</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@Body</span><span class="p">(</span><span class="k">new</span> <span class="nx">ValidationPipe</span><span class="p">())</span> <span class="nx">createCatDto</span>: <span class="kt">CreateCatDto</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">createCatDto</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ë§¤ê°œë³€ìˆ˜ ìŠ¤ì½”í”„ íŒŒì´í”„ëŠ” ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§ì´ íŠ¹ì • ë§¤ê°œë³€ìˆ˜ì—ë§Œ ê´€ë ¨ëœ ê²½ìš° ìœ ìš©í•©ë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="global-scoped-pipeshttpsdocsnestjscompipesglobal-scoped-pipes">Global scoped pipes<a href="https://docs.nestjs.com/pipes#global-scoped-pipes" target="_blank" rel="noopener noreffer ">#</a></h3>
<p><code>ValidationPipe</code>ì€ ê°€ëŠ¥í•œ í•œ ì¼ë°˜ì ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œê¸° ë•Œë¬¸ì— <strong>ì „ì—­ ìŠ¤ì½”í”„</strong> íŒŒì´í”„ë¡œ ì„¤ì •í•˜ì—¬ ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ëª¨ë“  ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì— ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//main.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">bootstrap() {</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">NestFactory</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">AppModule</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">app</span><span class="p">.</span><span class="nx">useGlobalPipes</span><span class="p">(</span><span class="k">new</span> <span class="nx">ValidationPipe</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">  <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">bootstrap</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>NOTICE</strong></p>
<p><a href="https://docs.nestjs.com/faq/hybrid-application" target="_blank" rel="noopener noreffer ">hybrid apps</a>ì˜ ê²½ìš° <code>useGlobalPipes()</code> ë©”ì„œë“œëŠ” ê²Œì´íŠ¸ì›¨ì´ ë° ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ íŒŒì´í”„ë¥¼ ì„¤ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. &ldquo;í‘œì¤€&rdquo; (ë¹„í•˜ì´ë¸Œë¦¬ë“œ) ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•±ì˜ ê²½ìš° <code>useGlobalPipes()</code>ëŠ” íŒŒì´í”„ë¥¼ ì „ì—­ìœ¼ë¡œ ë§ˆìš´íŠ¸í•©ë‹ˆë‹¤.</p></blockquote>
<p>ì „ì—­ íŒŒì´í”„ëŠ” ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜, ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ ë° ëª¨ë“  ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
<p>ì˜ì¡´ì„± ì£¼ì… ê´€ì ì—ì„œ ì£¼ì˜í•  ì ì€ ëª¨ë“ˆ ì™¸ë¶€ì—ì„œ ë“±ë¡ëœ ì „ì—­ íŒŒì´í”„(<code>useGlobalPipes()</code>ë¥¼ ì‚¬ìš©í•œ ê²½ìš°ì™€ ê°™ì´)ëŠ” ëª¨ë“ˆì˜ ì»¨í…ìŠ¤íŠ¸ ì™¸ë¶€ì—ì„œ ë°”ì¸ë”©ë˜ì—ˆê¸° ë•Œë¬¸ì— ì˜ì¡´ì„±ì„ ì£¼ì…í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì´ êµ¬ì„±ì„ ì‚¬ìš©í•˜ì—¬ <strong>ì–´ë–¤ ëª¨ë“ˆì—ì„œë“  ì§ì ‘</strong> ì „ì—­ íŒŒì´í”„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//app.module.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">APP_PIPE</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/core&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Module</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">provide</span>: <span class="kt">APP_PIPE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">useClass</span>: <span class="kt">ValidationPipe</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>HINT</strong></p>
<p>íŒŒì´í”„ì— ëŒ€í•œ ì˜ì¡´ì„± ì£¼ì…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì´ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•  ë•Œ, ì´ êµ¬ì„±ì´ ì‚¬ìš©ëœ ëª¨ë“ˆì— ê´€ê³„ì—†ì´ íŒŒì´í”„ëŠ” ì‚¬ì‹¤ìƒ ì „ì—­ì…ë‹ˆë‹¤. ì´ë¥¼ ì–´ë””ì— ì„¤ì •í•´ì•¼ í• ê¹Œìš”? íŒŒì´í”„(ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” <code>ValidationPipe</code>)ê°€ ì •ì˜ëœ ëª¨ë“ˆì„ ì„ íƒí•˜ì„¸ìš”. ë˜í•œ <code>useClass</code>ëŠ” ì‚¬ìš©ì ì§€ì • í”„ë¡œë°”ì´ë” ë“±ë¡ì„ ë‹¤ë£¨ëŠ” ìœ ì¼í•œ ë°©ë²•ì´ ì•„ë‹™ë‹ˆë‹¤. ì—¬ê¸°ì—ì„œ ë” ì•Œì•„ë³´ì„¸ìš”.</p></blockquote>
<p>â€‹</p>
<h3 id="the-built-in-validationpipehttpsdocsnestjscompipesthe-built-in-validationpipe">The built-in ValidationPipe<a href="https://docs.nestjs.com/pipes#the-built-in-validationpipe" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ê¸°ì–µí•˜ì„¸ìš”. <code>ValidationPipe</code>ì€ Nestì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µë˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ì •ì˜ ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ë¥¼ ì§ì ‘ ì‘ì„±í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ë‚´ì¥ëœ <code>ValidationPipe</code>ì€ ì´ ì¥ì—ì„œ ë§Œë“  ìƒ˜í”Œë³´ë‹¤ ë” ë§ì€ ì˜µì…˜ì„ ì œê³µí•˜ë©°, ì´ ìƒ˜í”Œì€ ì‚¬ìš©ì ì •ì˜ íŒŒì´í”„ì˜ ë©”ì»¤ë‹ˆì¦˜ì„ ì„¤ëª…í•˜ê¸° ìœ„í•´ ê¸°ë³¸ìœ¼ë¡œ ìœ ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ê³¼ ë‹¤ì–‘í•œ ì˜ˆì œëŠ” <a href="https://docs.nestjs.com/techniques/validation" target="_blank" rel="noopener noreffer ">ì—¬ê¸°</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="transformation-use-casehttpsdocsnestjscompipestransformation-use-case">Transformation use case<a href="https://docs.nestjs.com/pipes#transformation-use-case" target="_blank" rel="noopener noreffer ">#</a></h3>
<p>ìœ íš¨ì„± ê²€ì‚¬ëŠ” ì‚¬ìš©ì ì •ì˜ íŒŒì´í”„ì˜ ìœ ì¼í•œ ì‚¬ìš© ì‚¬ë¡€ê°€ ì•„ë‹™ë‹ˆë‹¤. ì´ ì¥ì˜ ì‹œì‘ì—ì„œ íŒŒì´í”„ê°€ ì…ë ¥ ë°ì´í„°ë¥¼ ì›í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ <strong>ë³€í™˜</strong>í•  ìˆ˜ë„ ìˆë‹¤ê³  ì–¸ê¸‰í–ˆìŠµë‹ˆë‹¤. ì´ëŠ” <code>transform</code> í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ê°’ì´ ì¸ìˆ˜ì˜ ì´ì „ ê°’ ì „ì²´ë¥¼ ì™„ì „íˆ ëŒ€ì²´í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<p>ì´ê²ƒì´ ìœ ìš©í•œ ê²½ìš°ëŠ” ì–¸ì œì¼ê¹Œìš”? ë•Œë¡œëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì „ë‹¬ëœ ë°ì´í„°ê°€ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì—ì„œ ì ì ˆí•˜ê²Œ ì²˜ë¦¬ë˜ê¸° ì „ì— ì–´ë– í•œ ë³€ê²½ì„ ê±°ì³ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë¬¸ìì—´ì„ ì •ìˆ˜ë¡œ ë³€í™˜í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì¼ë¶€ í•„ìˆ˜ ë°ì´í„° í•„ë“œê°€ ëˆ„ë½ëœ ê²½ìš° ê¸°ë³¸ê°’ì„ ì ìš©í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <strong>ë³€í™˜ íŒŒì´í”„</strong>ëŠ” ì´ëŸ¬í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë©° í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ê³¼ ìš”ì²­ í•¸ë“¤ëŸ¬ ì‚¬ì´ì— ì²˜ë¦¬ í•¨ìˆ˜ë¥¼ ë¼ì›Œë„£ì–´ ì‘ë™í•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒì€ ë¬¸ìì—´ì„ ì •ìˆ˜ ê°’ìœ¼ë¡œ íŒŒì‹±í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” ê°„ë‹¨í•œ <code>ParseIntPipe</code>ì˜ ì˜ˆì œì…ë‹ˆë‹¤. (ì•ì„œ ì–¸ê¸‰í•œ ëŒ€ë¡œ Nestì—ëŠ” ë” ì •êµí•œ ë‚´ì¥ <code>ParseIntPipe</code>ê°€ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ì‚¬ìš©ì ì •ì˜ ë³€í™˜ íŒŒì´í”„ì˜ ê°„ë‹¨í•œ ì˜ˆë¡œ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="c1">//parse-int.pipe.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">PipeTransform</span><span class="p">,</span> <span class="nx">Injectable</span><span class="p">,</span> <span class="nx">ArgumentMetadata</span><span class="p">,</span> <span class="nx">BadRequestException</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Injectable</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">ParseIntPipe</span> <span class="kr">implements</span> <span class="nx">PipeTransform</span><span class="p">&lt;</span><span class="nt">string</span><span class="p">,</span> <span class="na">number</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">transform</span><span class="p">(</span><span class="nx">value</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">metadata</span>: <span class="kt">ArgumentMetadata</span><span class="p">)</span><span class="o">:</span> <span class="kt">number</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">val</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">val</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">BadRequestException</span><span class="p">(</span><span class="s1">&#39;Validation failed&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can then bind this pipe to the selected param as shown below:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findOne</span><span class="p">(</span><span class="kd">@Param</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">ParseIntPipe</span><span class="p">())</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ë˜ ë‹¤ë¥¸ ìœ ìš©í•œ ë³€í™˜ ì‚¬ë¡€ëŠ” ìš”ì²­ì—ì„œ ì œê³µëœ IDë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ <strong>ê¸°ì¡´ ì‚¬ìš©ì</strong> ì—”í„°í‹°ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">findOne</span><span class="p">(</span><span class="kd">@Param</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">UserByIdPipe</span><span class="p">)</span> <span class="nx">userEntity</span>: <span class="kt">UserEntity</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">userEntity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì´ íŒŒì´í”„ì˜ êµ¬í˜„ì€ ë…ìì—ê²Œ ë§¡ê²¨ë‘¡ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‹¤ë¥¸ ëª¨ë“  ë³€í™˜ íŒŒì´í”„ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì´ëŠ” ì…ë ¥ ê°’(<code>id</code>)ì„ ë°›ì•„ ì¶œë ¥ ê°’(<code>UserEntity</code> ê°ì²´)ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ê³µí†µ íŒŒì´í”„ë¡œ í•¸ë“¤ëŸ¬ì—ì„œì˜ ë°˜ë³µ ì½”ë“œë¥¼ ì¶”ìƒí™”í•˜ì—¬ ì½”ë“œë¥¼ ë” ì„ ì–¸ì ì´ê³  <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" target="_blank" rel="noopener noreffer ">DRY</a>í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>â€‹</p>
<h3 id="providing-defaultshttpsdocsnestjscompipesproviding-defaults">Providing defaults<a href="https://docs.nestjs.com/pipes#providing-defaults" target="_blank" rel="noopener noreffer ">#</a></h3>
<p><code>Parse*</code> íŒŒì´í”„ë“¤ì€ ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì„ ì •ì˜ë˜ì–´ ìˆë‹¤ê³  ê¸°ëŒ€í•©ë‹ˆë‹¤. <code>null</code> ë˜ëŠ” <code>undefined</code> ê°’ì„ ë°›ìœ¼ë©´ ì˜ˆì™¸ë¥¼ throwí•©ë‹ˆë‹¤. ì¿¼ë¦¬ ë¬¸ìì—´ ë§¤ê°œë³€ìˆ˜ ê°’ì´ ëˆ„ë½ëœ ê²½ìš°ì— ëŒ€ë¹„í•´ ì—”ë“œí¬ì¸íŠ¸ê°€ ì´ë¥¼ ì²˜ë¦¬í•˜ë„ë¡ í•˜ë ¤ë©´ <code>Parse*</code> íŒŒì´í”„ê°€ ì´ëŸ¬í•œ ê°’ì„ ì²˜ë¦¬í•˜ê¸° ì „ì— ì£¼ì…ë  ê¸°ë³¸ê°’ì„ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ <code>DefaultValuePipe</code>ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ê°„ë‹¨íˆ ì•„ë˜ì™€ ê°™ì´ ê´€ë ¨ëœ <code>Parse*</code> íŒŒì´í”„ ì•ì— <code>@Query()</code> ë°ì½”ë ˆì´í„°ì—ì„œ <code>DefaultValuePipe</code>ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ë©´ ë©ë‹ˆë‹¤:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kd">@Get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="nx">findAll</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@Query</span><span class="p">(</span><span class="s1">&#39;activeOnly&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">DefaultValuePipe</span><span class="p">(</span><span class="kc">false</span><span class="p">),</span> <span class="nx">ParseBoolPipe</span><span class="p">)</span> <span class="nx">activeOnly</span>: <span class="kt">boolean</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="kd">@Query</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">DefaultValuePipe</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nx">ParseIntPipe</span><span class="p">)</span> <span class="nx">page</span>: <span class="kt">number</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">catsService</span><span class="p">.</span><span class="nx">findAll</span><span class="p">({</span> <span class="nx">activeOnly</span><span class="p">,</span> <span class="nx">page</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹</p>
<p>â€‹</p>
<p>â€‹</p>
<p>â€‹</p>
<p>â€‹</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-01-14</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/nest-official_02_modules-middleware-exception_filters-pipes/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/nest/">Nest</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/staticdynamictype/" class="prev" rel="prev" title="what is ì •ì (static) &amp; ë™ì (dynamic) Type"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>what is ì •ì (static) & ë™ì (dynamic) Type</a>
            <a href="/nest-official_03_guards-interceptors-custom_decorators/" class="next" rel="next" title="Nest Official_03_(Guards, Interceptors, Custom_decorators)">Nest Official_03_(Guards, Interceptors, Custom_decorators)<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.143.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2020 - 2026</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">colinder</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/css/_custom.scss"><script type="text/javascript" src="https://colinder-github-io.disqus.com/embed.js" defer></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":200},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
